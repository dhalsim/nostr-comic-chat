var ua=Object.defineProperty;var fa=(je,U,$e)=>U in je?ua(je,U,{enumerable:!0,configurable:!0,writable:!0,value:$e}):je[U]=$e;var v=(je,U,$e)=>fa(je,typeof U!="symbol"?U+"":U,$e);(function(){"use strict";var bo,go,po,wo,yo;const je='*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before,:after{--tw-content: ""}html,:host{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.fixed{position:fixed}.absolute{position:absolute}.bottom-1{bottom:.25rem}.right-2{right:.5rem}.right-3{right:.75rem}.top-0{top:0}.z-\\[9000\\]{z-index:9000}.m-auto{margin:auto}.my-2{margin-top:.5rem;margin-bottom:.5rem}.mb-1{margin-bottom:.25rem}.mb-2{margin-bottom:.5rem}.mb-4{margin-bottom:1rem}.ml-2{margin-left:.5rem}.mr-2{margin-right:.5rem}.mt-4{margin-top:1rem}.mt-6{margin-top:1.5rem}.box-border{box-sizing:border-box}.block{display:block}.inline-block{display:inline-block}.inline{display:inline}.flex{display:flex}.h-10{height:2.5rem}.h-5{height:1.25rem}.h-6{height:1.5rem}.w-10{width:2.5rem}.w-5{width:1.25rem}.w-6{width:1.5rem}.w-full{width:100%}.max-w-56{max-width:14rem}@keyframes moveIn{0%{transform:translateY(-10px)}to{transform:translateY(0)}}.animate-fadein{animation:fadeIn 1s ease-in-out,moveIn 1s ease-in-out}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}.animate-show{animation:fadeIn .2s ease-in-out}@keyframes spin{to{transform:rotate(360deg)}}.animate-spin{animation:spin 1s linear infinite}.cursor-grabbing{cursor:grabbing}.cursor-pointer{cursor:pointer}.flex-col{flex-direction:column}.items-center{align-items:center}.justify-center{justify-content:center}.gap-2{gap:.5rem}.overflow-hidden{overflow:hidden}.overflow-ellipsis{text-overflow:ellipsis}.whitespace-nowrap{white-space:nowrap}.break-all{word-break:break-all}.rounded{border-radius:.25rem}.rounded-full{border-radius:9999px}.rounded-md{border-radius:.375rem}.border-0{border-width:0px}.border-2{border-width:2px}.border-solid{border-style:solid}.border-transparent{border-color:transparent}.bg-cyan-700{--tw-bg-opacity: 1;background-color:rgb(14 116 144 / var(--tw-bg-opacity, 1))}.bg-cyan-800{--tw-bg-opacity: 1;background-color:rgb(21 94 117 / var(--tw-bg-opacity, 1))}.bg-cyan-900{--tw-bg-opacity: 1;background-color:rgb(22 78 99 / var(--tw-bg-opacity, 1))}.bg-cyan-950{--tw-bg-opacity: 1;background-color:rgb(8 51 68 / var(--tw-bg-opacity, 1))}.bg-green-700{--tw-bg-opacity: 1;background-color:rgb(21 128 61 / var(--tw-bg-opacity, 1))}.bg-green-800{--tw-bg-opacity: 1;background-color:rgb(22 101 52 / var(--tw-bg-opacity, 1))}.bg-green-900{--tw-bg-opacity: 1;background-color:rgb(20 83 45 / var(--tw-bg-opacity, 1))}.bg-green-950{--tw-bg-opacity: 1;background-color:rgb(5 46 22 / var(--tw-bg-opacity, 1))}.bg-neutral-700{--tw-bg-opacity: 1;background-color:rgb(64 64 64 / var(--tw-bg-opacity, 1))}.bg-neutral-800{--tw-bg-opacity: 1;background-color:rgb(38 38 38 / var(--tw-bg-opacity, 1))}.bg-neutral-900{--tw-bg-opacity: 1;background-color:rgb(23 23 23 / var(--tw-bg-opacity, 1))}.bg-neutral-950{--tw-bg-opacity: 1;background-color:rgb(10 10 10 / var(--tw-bg-opacity, 1))}.bg-orange-700{--tw-bg-opacity: 1;background-color:rgb(194 65 12 / var(--tw-bg-opacity, 1))}.bg-orange-800{--tw-bg-opacity: 1;background-color:rgb(154 52 18 / var(--tw-bg-opacity, 1))}.bg-orange-900{--tw-bg-opacity: 1;background-color:rgb(124 45 18 / var(--tw-bg-opacity, 1))}.bg-orange-950{--tw-bg-opacity: 1;background-color:rgb(67 20 7 / var(--tw-bg-opacity, 1))}.bg-purple-700{--tw-bg-opacity: 1;background-color:rgb(126 34 206 / var(--tw-bg-opacity, 1))}.bg-purple-800{--tw-bg-opacity: 1;background-color:rgb(107 33 168 / var(--tw-bg-opacity, 1))}.bg-purple-900{--tw-bg-opacity: 1;background-color:rgb(88 28 135 / var(--tw-bg-opacity, 1))}.bg-purple-950{--tw-bg-opacity: 1;background-color:rgb(59 7 100 / var(--tw-bg-opacity, 1))}.bg-red-700{--tw-bg-opacity: 1;background-color:rgb(185 28 28 / var(--tw-bg-opacity, 1))}.bg-red-800{--tw-bg-opacity: 1;background-color:rgb(153 27 27 / var(--tw-bg-opacity, 1))}.bg-red-900{--tw-bg-opacity: 1;background-color:rgb(127 29 29 / var(--tw-bg-opacity, 1))}.bg-red-950{--tw-bg-opacity: 1;background-color:rgb(69 10 10 / var(--tw-bg-opacity, 1))}.bg-stone-700{--tw-bg-opacity: 1;background-color:rgb(68 64 60 / var(--tw-bg-opacity, 1))}.bg-stone-800{--tw-bg-opacity: 1;background-color:rgb(41 37 36 / var(--tw-bg-opacity, 1))}.bg-stone-900{--tw-bg-opacity: 1;background-color:rgb(28 25 23 / var(--tw-bg-opacity, 1))}.bg-stone-950{--tw-bg-opacity: 1;background-color:rgb(12 10 9 / var(--tw-bg-opacity, 1))}.bg-transparent{background-color:transparent}.bg-yellow-100{--tw-bg-opacity: 1;background-color:rgb(254 249 195 / var(--tw-bg-opacity, 1))}.bg-gradient-to-b{background-image:linear-gradient(to bottom,var(--tw-gradient-stops))}.from-cyan-900{--tw-gradient-from: #164e63 var(--tw-gradient-from-position);--tw-gradient-to: rgb(22 78 99 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-green-900{--tw-gradient-from: #14532d var(--tw-gradient-from-position);--tw-gradient-to: rgb(20 83 45 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-neutral-900{--tw-gradient-from: #171717 var(--tw-gradient-from-position);--tw-gradient-to: rgb(23 23 23 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-orange-900{--tw-gradient-from: #7c2d12 var(--tw-gradient-from-position);--tw-gradient-to: rgb(124 45 18 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-900{--tw-gradient-from: #581c87 var(--tw-gradient-from-position);--tw-gradient-to: rgb(88 28 135 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-red-900{--tw-gradient-from: #7f1d1d var(--tw-gradient-from-position);--tw-gradient-to: rgb(127 29 29 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-stone-900{--tw-gradient-from: #1c1917 var(--tw-gradient-from-position);--tw-gradient-to: rgb(28 25 23 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.to-cyan-700{--tw-gradient-to: #0e7490 var(--tw-gradient-to-position)}.to-green-700{--tw-gradient-to: #15803d var(--tw-gradient-to-position)}.to-neutral-700{--tw-gradient-to: #404040 var(--tw-gradient-to-position)}.to-orange-700{--tw-gradient-to: #c2410c var(--tw-gradient-to-position)}.to-purple-700{--tw-gradient-to: #7e22ce var(--tw-gradient-to-position)}.to-red-700{--tw-gradient-to: #b91c1c var(--tw-gradient-to-position)}.to-stone-700{--tw-gradient-to: #44403c var(--tw-gradient-to-position)}.p-2{padding:.5rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-8{padding-left:2rem;padding-right:2rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.py-8{padding-top:2rem;padding-bottom:2rem}.text-center{text-align:center}.font-sans{font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji"}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-base{font-size:1rem;line-height:1.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.leading-3{line-height:.75rem}.leading-4{line-height:1rem}.leading-5{line-height:1.25rem}.text-cyan-600{--tw-text-opacity: 1;color:rgb(8 145 178 / var(--tw-text-opacity, 1))}.text-green-600{--tw-text-opacity: 1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.text-neutral-600{--tw-text-opacity: 1;color:rgb(82 82 82 / var(--tw-text-opacity, 1))}.text-neutral-800{--tw-text-opacity: 1;color:rgb(38 38 38 / var(--tw-text-opacity, 1))}.text-orange-600{--tw-text-opacity: 1;color:rgb(234 88 12 / var(--tw-text-opacity, 1))}.text-purple-600{--tw-text-opacity: 1;color:rgb(147 51 234 / var(--tw-text-opacity, 1))}.text-red-400{--tw-text-opacity: 1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.text-red-600{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-stone-600{--tw-text-opacity: 1;color:rgb(87 83 78 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.underline{text-decoration-line:underline}.no-underline{text-decoration-line:none}.decoration-2{text-decoration-thickness:2px}.underline-offset-4{text-underline-offset:4px}.opacity-25{opacity:.25}.opacity-75{opacity:.75}.shadow-\\[0_0px_10px_0px_rgba\\(0\\,0\\,0\\,0\\.3\\)\\]{--tw-shadow: 0 0px 10px 0px rgba(0,0,0,.3);--tw-shadow-colored: 0 0px 10px 0px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\\[0_0px_30px_0px_rgba\\(0\\,0\\,0\\,0\\.6\\)\\]{--tw-shadow: 0 0px 30px 0px rgba(0,0,0,.6);--tw-shadow-colored: 0 0px 30px 0px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.outline-none{outline:2px solid transparent;outline-offset:2px}.outline-dashed{outline-style:dashed}.outline-1{outline-width:1px}.outline-offset-4{outline-offset:4px}.outline-cyan-500{outline-color:#06b6d4}.outline-green-500{outline-color:#22c55e}.outline-neutral-500{outline-color:#737373}.outline-orange-500{outline-color:#f97316}.outline-purple-500{outline-color:#a855f7}.outline-red-500{outline-color:#ef4444}.outline-stone-500{outline-color:#78716c}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.duration-200{transition-duration:.2s}.hover\\:bg-cyan-700:hover{--tw-bg-opacity: 1;background-color:rgb(14 116 144 / var(--tw-bg-opacity, 1))}.hover\\:bg-cyan-800:hover{--tw-bg-opacity: 1;background-color:rgb(21 94 117 / var(--tw-bg-opacity, 1))}.hover\\:bg-cyan-900:hover{--tw-bg-opacity: 1;background-color:rgb(22 78 99 / var(--tw-bg-opacity, 1))}.hover\\:bg-cyan-950:hover{--tw-bg-opacity: 1;background-color:rgb(8 51 68 / var(--tw-bg-opacity, 1))}.hover\\:bg-green-700:hover{--tw-bg-opacity: 1;background-color:rgb(21 128 61 / var(--tw-bg-opacity, 1))}.hover\\:bg-green-800:hover{--tw-bg-opacity: 1;background-color:rgb(22 101 52 / var(--tw-bg-opacity, 1))}.hover\\:bg-green-900:hover{--tw-bg-opacity: 1;background-color:rgb(20 83 45 / var(--tw-bg-opacity, 1))}.hover\\:bg-green-950:hover{--tw-bg-opacity: 1;background-color:rgb(5 46 22 / var(--tw-bg-opacity, 1))}.hover\\:bg-neutral-700:hover{--tw-bg-opacity: 1;background-color:rgb(64 64 64 / var(--tw-bg-opacity, 1))}.hover\\:bg-neutral-800:hover{--tw-bg-opacity: 1;background-color:rgb(38 38 38 / var(--tw-bg-opacity, 1))}.hover\\:bg-neutral-900:hover{--tw-bg-opacity: 1;background-color:rgb(23 23 23 / var(--tw-bg-opacity, 1))}.hover\\:bg-neutral-950:hover{--tw-bg-opacity: 1;background-color:rgb(10 10 10 / var(--tw-bg-opacity, 1))}.hover\\:bg-orange-700:hover{--tw-bg-opacity: 1;background-color:rgb(194 65 12 / var(--tw-bg-opacity, 1))}.hover\\:bg-orange-800:hover{--tw-bg-opacity: 1;background-color:rgb(154 52 18 / var(--tw-bg-opacity, 1))}.hover\\:bg-orange-900:hover{--tw-bg-opacity: 1;background-color:rgb(124 45 18 / var(--tw-bg-opacity, 1))}.hover\\:bg-orange-950:hover{--tw-bg-opacity: 1;background-color:rgb(67 20 7 / var(--tw-bg-opacity, 1))}.hover\\:bg-purple-700:hover{--tw-bg-opacity: 1;background-color:rgb(126 34 206 / var(--tw-bg-opacity, 1))}.hover\\:bg-purple-800:hover{--tw-bg-opacity: 1;background-color:rgb(107 33 168 / var(--tw-bg-opacity, 1))}.hover\\:bg-purple-900:hover{--tw-bg-opacity: 1;background-color:rgb(88 28 135 / var(--tw-bg-opacity, 1))}.hover\\:bg-purple-950:hover{--tw-bg-opacity: 1;background-color:rgb(59 7 100 / var(--tw-bg-opacity, 1))}.hover\\:bg-red-700:hover{--tw-bg-opacity: 1;background-color:rgb(185 28 28 / var(--tw-bg-opacity, 1))}.hover\\:bg-red-800:hover{--tw-bg-opacity: 1;background-color:rgb(153 27 27 / var(--tw-bg-opacity, 1))}.hover\\:bg-red-900:hover{--tw-bg-opacity: 1;background-color:rgb(127 29 29 / var(--tw-bg-opacity, 1))}.hover\\:bg-red-950:hover{--tw-bg-opacity: 1;background-color:rgb(69 10 10 / var(--tw-bg-opacity, 1))}.hover\\:bg-stone-700:hover{--tw-bg-opacity: 1;background-color:rgb(68 64 60 / var(--tw-bg-opacity, 1))}.hover\\:bg-stone-800:hover{--tw-bg-opacity: 1;background-color:rgb(41 37 36 / var(--tw-bg-opacity, 1))}.hover\\:bg-stone-900:hover{--tw-bg-opacity: 1;background-color:rgb(28 25 23 / var(--tw-bg-opacity, 1))}.hover\\:bg-stone-950:hover{--tw-bg-opacity: 1;background-color:rgb(12 10 9 / var(--tw-bg-opacity, 1))}.disabled\\:cursor-default:disabled{cursor:default}.disabled\\:bg-neutral-400:disabled{--tw-bg-opacity: 1;background-color:rgb(163 163 163 / var(--tw-bg-opacity, 1))}.disabled\\:text-neutral-200:disabled{--tw-text-opacity: 1;color:rgb(229 229 229 / var(--tw-text-opacity, 1))}.group:hover .group-hover\\:underline{text-decoration-line:underline}@media (min-width: 640px){.sm\\:w-96{width:24rem}}';function U(){}function $e(t){return t()}function Un(){return Object.create(null)}function Ie(t){t.forEach($e)}function jt(t){return typeof t=="function"}function $t(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let wt;function Ye(t,e){return t===e?!0:(wt||(wt=document.createElement("a")),wt.href=e,t===wt.href)}function Eo(t){return Object.keys(t).length===0}function _o(t,...e){if(t==null){for(const r of e)r(void 0);return U}const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function ko(t,e,n){t.$$.on_destroy.push(_o(e,n))}const So=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function I(t,e){t.appendChild(e)}function H(t,e,n){t.insertBefore(e,n||null)}function R(t){t.parentNode&&t.parentNode.removeChild(t)}function O(t){return document.createElement(t)}function zt(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function V(t){return document.createTextNode(t)}function Z(){return V(" ")}function Mn(){return V("")}function te(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function E(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Ao(t){return Array.from(t.childNodes)}function Oe(t,e){e=""+e,t.data!==e&&(t.data=e)}function qn(t,e){t.value=e??""}function jn(t,e,n){t.classList.toggle(e,!!n)}let lt;function ut(t){lt=t}function Bo(){if(!lt)throw new Error("Function called outside component initialization");return lt}function Io(t){Bo().$$.on_mount.push(t)}const Ze=[],yt=[];let Je=[];const $n=[],Oo=Promise.resolve();let Kt=!1;function To(){Kt||(Kt=!0,Oo.then(zn))}function Wt(t){Je.push(t)}const Dt=new Set;let Qe=0;function zn(){if(Qe!==0)return;const t=lt;do{try{for(;Qe<Ze.length;){const e=Ze[Qe];Qe++,ut(e),Po(e.$$)}}catch(e){throw Ze.length=0,Qe=0,e}for(ut(null),Ze.length=0,Qe=0;yt.length;)yt.pop()();for(let e=0;e<Je.length;e+=1){const n=Je[e];Dt.has(n)||(Dt.add(n),n())}Je.length=0}while(Ze.length);for(;$n.length;)$n.pop()();Kt=!1,Dt.clear(),ut(t)}function Po(t){if(t.fragment!==null){t.update(),Ie(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Wt)}}function No(t){const e=[],n=[];Je.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),Je=e}const mt=new Set;let ze;function vt(){ze={r:0,c:[],p:ze}}function xt(){ze.r||Ie(ze.c),ze=ze.p}function de(t,e){t&&t.i&&(mt.delete(t),t.i(e))}function pe(t,e,n,r){if(t&&t.o){if(mt.has(t))return;mt.add(t),ze.c.push(()=>{mt.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}function Kn(t){t&&t.c()}function Vt(t,e,n){const{fragment:r,after_update:o}=t.$$;r&&r.m(e,n),Wt(()=>{const i=t.$$.on_mount.map($e).filter(jt);t.$$.on_destroy?t.$$.on_destroy.push(...i):Ie(i),t.$$.on_mount=[]}),o.forEach(Wt)}function Ft(t,e){const n=t.$$;n.fragment!==null&&(No(n.after_update),Ie(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Co(t,e){t.$$.dirty[0]===-1&&(Ze.push(t),To(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Wn(t,e,n,r,o,i,s=null,c=[-1]){const a=lt;ut(t);const l=t.$$={fragment:null,ctx:[],props:i,update:U,not_equal:o,bound:Un(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:Un(),dirty:c,skip_bound:!1,root:e.target||a.$$.root};s&&s(l.root);let f=!1;if(l.ctx=n?n(t,e.props||{},(u,h,...d)=>{const w=d.length?d[0]:h;return l.ctx&&o(l.ctx[u],l.ctx[u]=w)&&(!l.skip_bound&&l.bound[u]&&l.bound[u](w),f&&Co(t,u)),h}):[],l.update(),f=!0,Ie(l.before_update),l.fragment=r?r(l.ctx):!1,e.target){if(e.hydrate){const u=Ao(e.target);l.fragment&&l.fragment.l(u),u.forEach(R)}else l.fragment&&l.fragment.c();e.intro&&de(t.$$.fragment),Vt(t,e.target,e.anchor),zn()}ut(a)}class Dn{constructor(){v(this,"$$");v(this,"$$set")}$destroy(){Ft(this,1),this.$destroy=U}$on(e,n){if(!jt(n))return U;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const o=r.indexOf(n);o!==-1&&r.splice(o,1)}}$set(e){this.$$set&&!Eo(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Lo="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Lo);function Ro(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Gt={exports:{}};function Vn(t,e=100,n={}){if(typeof t!="function")throw new TypeError(`Expected the first parameter to be a function, got \`${typeof t}\`.`);if(e<0)throw new RangeError("`wait` must not be negative.");const{immediate:r}=typeof n=="boolean"?{immediate:n}:n;let o,i,s,c,a;function l(){const u=Date.now()-c;if(u<e&&u>=0)s=setTimeout(l,e-u);else if(s=void 0,!r){const h=o,d=i;o=void 0,i=void 0,a=t.apply(h,d)}}const f=function(...u){if(o&&this!==o)throw new Error("Debounced method called with different contexts.");o=this,i=u,c=Date.now();const h=r&&!s;if(s||(s=setTimeout(l,e)),h){const d=o,w=i;o=void 0,i=void 0,a=t.apply(d,w)}return a};return f.clear=()=>{s&&(clearTimeout(s),s=void 0)},f.flush=()=>{if(!s)return;const u=o,h=i;o=void 0,i=void 0,a=t.apply(u,h),clearTimeout(s),s=void 0},f}Gt.exports.debounce=Vn,Gt.exports=Vn;var Ho=Gt.exports;const Uo=Ro(Ho),Yt=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Zt=t=>t instanceof Uint8Array,Jt=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),we=(t,e)=>t<<32-e|t>>>e;if(!(new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68))throw new Error("Non little-endian hardware is not supported");const Mo=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function ce(t){if(!Zt(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=Mo[t[n]];return e}function Fn(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let r=0;r<n.length;r++){const o=r*2,i=t.slice(o,o+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");n[r]=s}return n}function qo(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function ft(t){if(typeof t=="string"&&(t=qo(t)),!Zt(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function Qt(...t){const e=new Uint8Array(t.reduce((r,o)=>r+o.length,0));let n=0;return t.forEach(r=>{if(!Zt(r))throw new Error("Uint8Array expected");e.set(r,n),n+=r.length}),e}let Gn=class{clone(){return this._cloneInto()}};function Yn(t){const e=r=>t().update(ft(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function jo(t=32){if(Yt&&typeof Yt.getRandomValues=="function")return Yt.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function Zn(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Jn(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function $o(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Zn(t.outputLen),Zn(t.blockLen)}function Et(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function zo(t,e){Jn(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const Xt=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Qn=t=>t instanceof Uint8Array,en=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),ye=(t,e)=>t<<32-e|t>>>e;if(!(new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68))throw new Error("Non little-endian hardware is not supported");function Ko(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function tn(t){if(typeof t=="string"&&(t=Ko(t)),!Qn(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function Wo(...t){const e=new Uint8Array(t.reduce((r,o)=>r+o.length,0));let n=0;return t.forEach(r=>{if(!Qn(r))throw new Error("Uint8Array expected");e.set(r,n),n+=r.length}),e}class Xn{clone(){return this._cloneInto()}}function Do(t){const e=r=>t().update(tn(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function er(t=32){if(Xt&&typeof Xt.getRandomValues=="function")return Xt.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function Vo(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),c=Number(n&i),a=r?4:0,l=r?0:4;t.setUint32(e+a,s,r),t.setUint32(e+l,c,r)}let Fo=class extends Xn{constructor(e,n,r,o){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=en(this.buffer)}update(e){Et(this);const{view:n,buffer:r,blockLen:o}=this;e=tn(e);const i=e.length;for(let s=0;s<i;){const c=Math.min(o-this.pos,i-s);if(c===o){const a=en(e);for(;o<=i-s;s+=o)this.process(a,s);continue}r.set(e.subarray(s,s+c),this.pos),this.pos+=c,s+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Et(this),zo(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:o,isLE:i}=this;let{pos:s}=this;n[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>o-s&&(this.process(r,0),s=0);for(let u=s;u<o;u++)n[u]=0;Vo(r,o-8,BigInt(this.length*8),i),this.process(r,0);const c=en(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=a/4,f=this.get();if(l>f.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<l;u++)c.setUint32(4*u,f[u],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:o,finished:i,destroyed:s,pos:c}=this;return e.length=o,e.pos=c,e.finished=i,e.destroyed=s,o%n&&e.buffer.set(r),e}};const Go=(t,e,n)=>t&e^~t&n,Yo=(t,e,n)=>t&e^t&n^e&n,Zo=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Te=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Pe=new Uint32Array(64);let Jo=class extends Fo{constructor(){super(64,32,8,!1),this.A=Te[0]|0,this.B=Te[1]|0,this.C=Te[2]|0,this.D=Te[3]|0,this.E=Te[4]|0,this.F=Te[5]|0,this.G=Te[6]|0,this.H=Te[7]|0}get(){const{A:e,B:n,C:r,D:o,E:i,F:s,G:c,H:a}=this;return[e,n,r,o,i,s,c,a]}set(e,n,r,o,i,s,c,a){this.A=e|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=i|0,this.F=s|0,this.G=c|0,this.H=a|0}process(e,n){for(let u=0;u<16;u++,n+=4)Pe[u]=e.getUint32(n,!1);for(let u=16;u<64;u++){const h=Pe[u-15],d=Pe[u-2],w=ye(h,7)^ye(h,18)^h>>>3,b=ye(d,17)^ye(d,19)^d>>>10;Pe[u]=b+Pe[u-7]+w+Pe[u-16]|0}let{A:r,B:o,C:i,D:s,E:c,F:a,G:l,H:f}=this;for(let u=0;u<64;u++){const h=ye(c,6)^ye(c,11)^ye(c,25),d=f+h+Go(c,a,l)+Zo[u]+Pe[u]|0,b=(ye(r,2)^ye(r,13)^ye(r,22))+Yo(r,o,i)|0;f=l,l=a,a=c,c=s+d|0,s=i,i=o,o=r,r=d+b|0}r=r+this.A|0,o=o+this.B|0,i=i+this.C|0,s=s+this.D|0,c=c+this.E|0,a=a+this.F|0,l=l+this.G|0,f=f+this.H|0,this.set(r,o,i,s,c,a,l,f)}roundClean(){Pe.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const nn=Do(()=>new Jo);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const tr=BigInt(0),_t=BigInt(1),Qo=BigInt(2),kt=t=>t instanceof Uint8Array,Xo=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Xe(t){if(!kt(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=Xo[t[n]];return e}function nr(t){const e=t.toString(16);return e.length&1?`0${e}`:e}function rn(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function et(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let r=0;r<n.length;r++){const o=r*2,i=t.slice(o,o+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");n[r]=s}return n}function se(t){return rn(Xe(t))}function on(t){if(!kt(t))throw new Error("Uint8Array expected");return rn(Xe(Uint8Array.from(t).reverse()))}function Ne(t,e){return et(t.toString(16).padStart(e*2,"0"))}function sn(t,e){return Ne(t,e).reverse()}function ei(t){return et(nr(t))}function re(t,e,n){let r;if(typeof e=="string")try{r=et(e)}catch(i){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${i}`)}else if(kt(e))r=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);const o=r.length;if(typeof n=="number"&&o!==n)throw new Error(`${t} expected ${n} bytes, got ${o}`);return r}function Ke(...t){const e=new Uint8Array(t.reduce((r,o)=>r+o.length,0));let n=0;return t.forEach(r=>{if(!kt(r))throw new Error("Uint8Array expected");e.set(r,n),n+=r.length}),e}function ti(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function ni(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function ri(t){let e;for(e=0;t>tr;t>>=_t,e+=1);return e}function oi(t,e){return t>>BigInt(e)&_t}const ii=(t,e,n)=>t|(n?_t:tr)<<BigInt(e),cn=t=>(Qo<<BigInt(t-1))-_t,an=t=>new Uint8Array(t),rr=t=>Uint8Array.from(t);function or(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=an(t),o=an(t),i=0;const s=()=>{r.fill(1),o.fill(0),i=0},c=(...u)=>n(o,r,...u),a=(u=an())=>{o=c(rr([0]),u),r=c(),u.length!==0&&(o=c(rr([1]),u),r=c())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let u=0;const h=[];for(;u<e;){r=c();const d=r.slice();h.push(d),u+=r.length}return Ke(...h)};return(u,h)=>{s(),a(u);let d;for(;!(d=h(l()));)a();return s(),d}}const si={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function dt(t,e,n={}){const r=(o,i,s)=>{const c=si[i];if(typeof c!="function")throw new Error(`Invalid validator "${i}", expected function`);const a=t[o];if(!(s&&a===void 0)&&!c(a,t))throw new Error(`Invalid param ${String(o)}=${a} (${typeof a}), expected ${i}`)};for(const[o,i]of Object.entries(e))r(o,i,!1);for(const[o,i]of Object.entries(n))r(o,i,!0);return t}const ci=Object.freeze(Object.defineProperty({__proto__:null,bitGet:oi,bitLen:ri,bitMask:cn,bitSet:ii,bytesToHex:Xe,bytesToNumberBE:se,bytesToNumberLE:on,concatBytes:Ke,createHmacDrbg:or,ensureBytes:re,equalBytes:ti,hexToBytes:et,hexToNumber:rn,numberToBytesBE:Ne,numberToBytesLE:sn,numberToHexUnpadded:nr,numberToVarBytesBE:ei,utf8ToBytes:ni,validateObject:dt},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ee=BigInt(0),J=BigInt(1),We=BigInt(2),ai=BigInt(3),ln=BigInt(4),ir=BigInt(5),sr=BigInt(8);BigInt(9),BigInt(16);function ne(t,e){const n=t%e;return n>=ee?n:e+n}function li(t,e,n){if(n<=ee||e<ee)throw new Error("Expected power/modulo > 0");if(n===J)return ee;let r=J;for(;e>ee;)e&J&&(r=r*t%n),t=t*t%n,e>>=J;return r}function ue(t,e,n){let r=t;for(;e-- >ee;)r*=r,r%=n;return r}function un(t,e){if(t===ee||e<=ee)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let n=ne(t,e),r=e,o=ee,i=J;for(;n!==ee;){const c=r/n,a=r%n,l=o-i*c;r=n,n=a,o=i,i=l}if(r!==J)throw new Error("invert: does not exist");return ne(o,e)}function ui(t){const e=(t-J)/We;let n,r,o;for(n=t-J,r=0;n%We===ee;n/=We,r++);for(o=We;o<t&&li(o,e,t)!==t-J;o++);if(r===1){const s=(t+J)/ln;return function(a,l){const f=a.pow(l,s);if(!a.eql(a.sqr(f),l))throw new Error("Cannot find square root");return f}}const i=(n+J)/We;return function(c,a){if(c.pow(a,e)===c.neg(c.ONE))throw new Error("Cannot find square root");let l=r,f=c.pow(c.mul(c.ONE,o),n),u=c.pow(a,i),h=c.pow(a,n);for(;!c.eql(h,c.ONE);){if(c.eql(h,c.ZERO))return c.ZERO;let d=1;for(let b=c.sqr(h);d<l&&!c.eql(b,c.ONE);d++)b=c.sqr(b);const w=c.pow(f,J<<BigInt(l-d-1));f=c.sqr(w),u=c.mul(u,w),h=c.mul(h,f),l=d}return u}}function fi(t){if(t%ln===ai){const e=(t+J)/ln;return function(r,o){const i=r.pow(o,e);if(!r.eql(r.sqr(i),o))throw new Error("Cannot find square root");return i}}if(t%sr===ir){const e=(t-ir)/sr;return function(r,o){const i=r.mul(o,We),s=r.pow(i,e),c=r.mul(o,s),a=r.mul(r.mul(c,We),s),l=r.mul(c,r.sub(a,r.ONE));if(!r.eql(r.sqr(l),o))throw new Error("Cannot find square root");return l}}return ui(t)}const di=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function hi(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=di.reduce((r,o)=>(r[o]="function",r),e);return dt(t,n)}function bi(t,e,n){if(n<ee)throw new Error("Expected power > 0");if(n===ee)return t.ONE;if(n===J)return e;let r=t.ONE,o=e;for(;n>ee;)n&J&&(r=t.mul(r,o)),o=t.sqr(o),n>>=J;return r}function gi(t,e){const n=new Array(e.length),r=e.reduce((i,s,c)=>t.is0(s)?i:(n[c]=i,t.mul(i,s)),t.ONE),o=t.inv(r);return e.reduceRight((i,s,c)=>t.is0(s)?i:(n[c]=t.mul(i,n[c]),t.mul(i,s)),o),n}function cr(t,e){const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function pi(t,e,n=!1,r={}){if(t<=ee)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:o,nByteLength:i}=cr(t,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=fi(t),c=Object.freeze({ORDER:t,BITS:o,BYTES:i,MASK:cn(o),ZERO:ee,ONE:J,create:a=>ne(a,t),isValid:a=>{if(typeof a!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof a}`);return ee<=a&&a<t},is0:a=>a===ee,isOdd:a=>(a&J)===J,neg:a=>ne(-a,t),eql:(a,l)=>a===l,sqr:a=>ne(a*a,t),add:(a,l)=>ne(a+l,t),sub:(a,l)=>ne(a-l,t),mul:(a,l)=>ne(a*l,t),pow:(a,l)=>bi(c,a,l),div:(a,l)=>ne(a*un(l,t),t),sqrN:a=>a*a,addN:(a,l)=>a+l,subN:(a,l)=>a-l,mulN:(a,l)=>a*l,inv:a=>un(a,t),sqrt:r.sqrt||(a=>s(c,a)),invertBatch:a=>gi(c,a),cmov:(a,l,f)=>f?l:a,toBytes:a=>n?sn(a,i):Ne(a,i),fromBytes:a=>{if(a.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${a.length}`);return n?on(a):se(a)}});return Object.freeze(c)}function ar(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function lr(t){const e=ar(t);return e+Math.ceil(e/2)}function wi(t,e,n=!1){const r=t.length,o=ar(e),i=lr(e);if(r<16||r<i||r>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${r}`);const s=n?se(t):on(t),c=ne(s,e-J)+J;return n?sn(c,o):Ne(c,o)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const yi=BigInt(0),fn=BigInt(1);function mi(t,e){const n=(o,i)=>{const s=i.negate();return o?s:i},r=o=>{const i=Math.ceil(e/o)+1,s=2**(o-1);return{windows:i,windowSize:s}};return{constTimeNegate:n,unsafeLadder(o,i){let s=t.ZERO,c=o;for(;i>yi;)i&fn&&(s=s.add(c)),c=c.double(),i>>=fn;return s},precomputeWindow(o,i){const{windows:s,windowSize:c}=r(i),a=[];let l=o,f=l;for(let u=0;u<s;u++){f=l,a.push(f);for(let h=1;h<c;h++)f=f.add(l),a.push(f);l=f.double()}return a},wNAF(o,i,s){const{windows:c,windowSize:a}=r(o);let l=t.ZERO,f=t.BASE;const u=BigInt(2**o-1),h=2**o,d=BigInt(o);for(let w=0;w<c;w++){const b=w*a;let g=Number(s&u);s>>=d,g>a&&(g-=h,s+=fn);const p=b,y=b+Math.abs(g)-1,k=w%2!==0,C=g<0;g===0?f=f.add(n(k,i[p])):l=l.add(n(C,i[y]))}return{p:l,f}},wNAFCached(o,i,s,c){const a=o._WINDOW_SIZE||1;let l=i.get(o);return l||(l=this.precomputeWindow(o,a),a!==1&&i.set(o,c(l))),this.wNAF(a,l,s)}}}function ur(t){return hi(t.Fp),dt(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...cr(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function vi(t){const e=ur(t);dt(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:o}=e;if(n){if(!r.eql(o,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:xi,hexToBytes:Ei}=ci,De={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){const{Err:e}=De;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");const n=t[1],r=t.subarray(2,n+2);if(!n||r.length!==n)throw new e("Invalid signature integer: wrong length");if(r[0]&128)throw new e("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:xi(r),l:t.subarray(n+2)}},toSig(t){const{Err:e}=De,n=typeof t=="string"?Ei(t):t;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||n[0]!=48)throw new e("Invalid signature tag");if(n[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:o,l:i}=De._parseInt(n.subarray(2)),{d:s,l:c}=De._parseInt(i);if(c.length)throw new e("Invalid signature: left bytes after parsing");return{r:o,s}},hexFromSig(t){const e=l=>Number.parseInt(l[0],16)&8?"00"+l:l,n=l=>{const f=l.toString(16);return f.length&1?`0${f}`:f},r=e(n(t.s)),o=e(n(t.r)),i=r.length/2,s=o.length/2,c=n(i),a=n(s);return`30${n(s+i+4)}02${a}${o}02${c}${r}`}},ve=BigInt(0),fe=BigInt(1);BigInt(2);const fr=BigInt(3);BigInt(4);function _i(t){const e=vi(t),{Fp:n}=e,r=e.toBytes||((w,b,g)=>{const p=b.toAffine();return Ke(Uint8Array.from([4]),n.toBytes(p.x),n.toBytes(p.y))}),o=e.fromBytes||(w=>{const b=w.subarray(1),g=n.fromBytes(b.subarray(0,n.BYTES)),p=n.fromBytes(b.subarray(n.BYTES,2*n.BYTES));return{x:g,y:p}});function i(w){const{a:b,b:g}=e,p=n.sqr(w),y=n.mul(p,w);return n.add(n.add(y,n.mul(w,b)),g)}if(!n.eql(n.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function s(w){return typeof w=="bigint"&&ve<w&&w<e.n}function c(w){if(!s(w))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function a(w){const{allowedPrivateKeyLengths:b,nByteLength:g,wrapPrivateKey:p,n:y}=e;if(b&&typeof w!="bigint"){if(w instanceof Uint8Array&&(w=Xe(w)),typeof w!="string"||!b.includes(w.length))throw new Error("Invalid key");w=w.padStart(g*2,"0")}let k;try{k=typeof w=="bigint"?w:se(re("private key",w,g))}catch{throw new Error(`private key must be ${g} bytes, hex or bigint, not ${typeof w}`)}return p&&(k=ne(k,y)),c(k),k}const l=new Map;function f(w){if(!(w instanceof u))throw new Error("ProjectivePoint expected")}class u{constructor(b,g,p){if(this.px=b,this.py=g,this.pz=p,b==null||!n.isValid(b))throw new Error("x required");if(g==null||!n.isValid(g))throw new Error("y required");if(p==null||!n.isValid(p))throw new Error("z required")}static fromAffine(b){const{x:g,y:p}=b||{};if(!b||!n.isValid(g)||!n.isValid(p))throw new Error("invalid affine point");if(b instanceof u)throw new Error("projective point not allowed");const y=k=>n.eql(k,n.ZERO);return y(g)&&y(p)?u.ZERO:new u(g,p,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(b){const g=n.invertBatch(b.map(p=>p.pz));return b.map((p,y)=>p.toAffine(g[y])).map(u.fromAffine)}static fromHex(b){const g=u.fromAffine(o(re("pointHex",b)));return g.assertValidity(),g}static fromPrivateKey(b){return u.BASE.multiply(a(b))}_setWindowSize(b){this._WINDOW_SIZE=b,l.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:b,y:g}=this.toAffine();if(!n.isValid(b)||!n.isValid(g))throw new Error("bad point: x or y not FE");const p=n.sqr(g),y=i(b);if(!n.eql(p,y))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:b}=this.toAffine();if(n.isOdd)return!n.isOdd(b);throw new Error("Field doesn't support isOdd")}equals(b){f(b);const{px:g,py:p,pz:y}=this,{px:k,py:C,pz:T}=b,S=n.eql(n.mul(g,T),n.mul(k,y)),_=n.eql(n.mul(p,T),n.mul(C,y));return S&&_}negate(){return new u(this.px,n.neg(this.py),this.pz)}double(){const{a:b,b:g}=e,p=n.mul(g,fr),{px:y,py:k,pz:C}=this;let T=n.ZERO,S=n.ZERO,_=n.ZERO,m=n.mul(y,y),P=n.mul(k,k),L=n.mul(C,C),q=n.mul(y,k);return q=n.add(q,q),_=n.mul(y,C),_=n.add(_,_),T=n.mul(b,_),S=n.mul(p,L),S=n.add(T,S),T=n.sub(P,S),S=n.add(P,S),S=n.mul(T,S),T=n.mul(q,T),_=n.mul(p,_),L=n.mul(b,L),q=n.sub(m,L),q=n.mul(b,q),q=n.add(q,_),_=n.add(m,m),m=n.add(_,m),m=n.add(m,L),m=n.mul(m,q),S=n.add(S,m),L=n.mul(k,C),L=n.add(L,L),m=n.mul(L,q),T=n.sub(T,m),_=n.mul(L,P),_=n.add(_,_),_=n.add(_,_),new u(T,S,_)}add(b){f(b);const{px:g,py:p,pz:y}=this,{px:k,py:C,pz:T}=b;let S=n.ZERO,_=n.ZERO,m=n.ZERO;const P=e.a,L=n.mul(e.b,fr);let q=n.mul(g,k),Y=n.mul(p,C),K=n.mul(y,T),D=n.add(g,p),x=n.add(k,C);D=n.mul(D,x),x=n.add(q,Y),D=n.sub(D,x),x=n.add(g,y);let A=n.add(k,T);return x=n.mul(x,A),A=n.add(q,K),x=n.sub(x,A),A=n.add(p,y),S=n.add(C,T),A=n.mul(A,S),S=n.add(Y,K),A=n.sub(A,S),m=n.mul(P,x),S=n.mul(L,K),m=n.add(S,m),S=n.sub(Y,m),m=n.add(Y,m),_=n.mul(S,m),Y=n.add(q,q),Y=n.add(Y,q),K=n.mul(P,K),x=n.mul(L,x),Y=n.add(Y,K),K=n.sub(q,K),K=n.mul(P,K),x=n.add(x,K),q=n.mul(Y,x),_=n.add(_,q),q=n.mul(A,x),S=n.mul(D,S),S=n.sub(S,q),q=n.mul(D,Y),m=n.mul(A,m),m=n.add(m,q),new u(S,_,m)}subtract(b){return this.add(b.negate())}is0(){return this.equals(u.ZERO)}wNAF(b){return d.wNAFCached(this,l,b,g=>{const p=n.invertBatch(g.map(y=>y.pz));return g.map((y,k)=>y.toAffine(p[k])).map(u.fromAffine)})}multiplyUnsafe(b){const g=u.ZERO;if(b===ve)return g;if(c(b),b===fe)return this;const{endo:p}=e;if(!p)return d.unsafeLadder(this,b);let{k1neg:y,k1:k,k2neg:C,k2:T}=p.splitScalar(b),S=g,_=g,m=this;for(;k>ve||T>ve;)k&fe&&(S=S.add(m)),T&fe&&(_=_.add(m)),m=m.double(),k>>=fe,T>>=fe;return y&&(S=S.negate()),C&&(_=_.negate()),_=new u(n.mul(_.px,p.beta),_.py,_.pz),S.add(_)}multiply(b){c(b);let g=b,p,y;const{endo:k}=e;if(k){const{k1neg:C,k1:T,k2neg:S,k2:_}=k.splitScalar(g);let{p:m,f:P}=this.wNAF(T),{p:L,f:q}=this.wNAF(_);m=d.constTimeNegate(C,m),L=d.constTimeNegate(S,L),L=new u(n.mul(L.px,k.beta),L.py,L.pz),p=m.add(L),y=P.add(q)}else{const{p:C,f:T}=this.wNAF(g);p=C,y=T}return u.normalizeZ([p,y])[0]}multiplyAndAddUnsafe(b,g,p){const y=u.BASE,k=(T,S)=>S===ve||S===fe||!T.equals(y)?T.multiplyUnsafe(S):T.multiply(S),C=k(this,g).add(k(b,p));return C.is0()?void 0:C}toAffine(b){const{px:g,py:p,pz:y}=this,k=this.is0();b==null&&(b=k?n.ONE:n.inv(y));const C=n.mul(g,b),T=n.mul(p,b),S=n.mul(y,b);if(k)return{x:n.ZERO,y:n.ZERO};if(!n.eql(S,n.ONE))throw new Error("invZ was invalid");return{x:C,y:T}}isTorsionFree(){const{h:b,isTorsionFree:g}=e;if(b===fe)return!0;if(g)return g(u,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:b,clearCofactor:g}=e;return b===fe?this:g?g(u,this):this.multiplyUnsafe(e.h)}toRawBytes(b=!0){return this.assertValidity(),r(u,this,b)}toHex(b=!0){return Xe(this.toRawBytes(b))}}u.BASE=new u(e.Gx,e.Gy,n.ONE),u.ZERO=new u(n.ZERO,n.ONE,n.ZERO);const h=e.nBitLength,d=mi(u,e.endo?Math.ceil(h/2):h);return{CURVE:e,ProjectivePoint:u,normPrivateKeyToScalar:a,weierstrassEquation:i,isWithinCurveOrder:s}}function ki(t){const e=ur(t);return dt(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function Si(t){const e=ki(t),{Fp:n,n:r}=e,o=n.BYTES+1,i=2*n.BYTES+1;function s(x){return ve<x&&x<n.ORDER}function c(x){return ne(x,r)}function a(x){return un(x,r)}const{ProjectivePoint:l,normPrivateKeyToScalar:f,weierstrassEquation:u,isWithinCurveOrder:h}=_i({...e,toBytes(x,A,N){const j=A.toAffine(),M=n.toBytes(j.x),W=Ke;return N?W(Uint8Array.from([A.hasEvenY()?2:3]),M):W(Uint8Array.from([4]),M,n.toBytes(j.y))},fromBytes(x){const A=x.length,N=x[0],j=x.subarray(1);if(A===o&&(N===2||N===3)){const M=se(j);if(!s(M))throw new Error("Point is not on curve");const W=u(M);let F=n.sqrt(W);const $=(F&fe)===fe;return(N&1)===1!==$&&(F=n.neg(F)),{x:M,y:F}}else if(A===i&&N===4){const M=n.fromBytes(j.subarray(0,n.BYTES)),W=n.fromBytes(j.subarray(n.BYTES,2*n.BYTES));return{x:M,y:W}}else throw new Error(`Point of length ${A} was invalid. Expected ${o} compressed bytes or ${i} uncompressed bytes`)}}),d=x=>Xe(Ne(x,e.nByteLength));function w(x){const A=r>>fe;return x>A}function b(x){return w(x)?c(-x):x}const g=(x,A,N)=>se(x.slice(A,N));class p{constructor(A,N,j){this.r=A,this.s=N,this.recovery=j,this.assertValidity()}static fromCompact(A){const N=e.nByteLength;return A=re("compactSignature",A,N*2),new p(g(A,0,N),g(A,N,2*N))}static fromDER(A){const{r:N,s:j}=De.toSig(re("DER",A));return new p(N,j)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(A){return new p(this.r,this.s,A)}recoverPublicKey(A){const{r:N,s:j,recovery:M}=this,W=_(re("msgHash",A));if(M==null||![0,1,2,3].includes(M))throw new Error("recovery id invalid");const F=M===2||M===3?N+e.n:N;if(F>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const $=M&1?"03":"02",ie=l.fromHex($+d(F)),Q=a(F),he=c(-W*Q),ke=c(j*Q),be=l.BASE.multiplyAndAddUnsafe(ie,he,ke);if(!be)throw new Error("point at infinify");return be.assertValidity(),be}hasHighS(){return w(this.s)}normalizeS(){return this.hasHighS()?new p(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return et(this.toDERHex())}toDERHex(){return De.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return et(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const y={isValidPrivateKey(x){try{return f(x),!0}catch{return!1}},normPrivateKeyToScalar:f,randomPrivateKey:()=>{const x=lr(e.n);return wi(e.randomBytes(x),e.n)},precompute(x=8,A=l.BASE){return A._setWindowSize(x),A.multiply(BigInt(3)),A}};function k(x,A=!0){return l.fromPrivateKey(x).toRawBytes(A)}function C(x){const A=x instanceof Uint8Array,N=typeof x=="string",j=(A||N)&&x.length;return A?j===o||j===i:N?j===2*o||j===2*i:x instanceof l}function T(x,A,N=!0){if(C(x))throw new Error("first arg must be private key");if(!C(A))throw new Error("second arg must be public key");return l.fromHex(A).multiply(f(x)).toRawBytes(N)}const S=e.bits2int||function(x){const A=se(x),N=x.length*8-e.nBitLength;return N>0?A>>BigInt(N):A},_=e.bits2int_modN||function(x){return c(S(x))},m=cn(e.nBitLength);function P(x){if(typeof x!="bigint")throw new Error("bigint expected");if(!(ve<=x&&x<m))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Ne(x,e.nByteLength)}function L(x,A,N=q){if(["recovered","canonical"].some(ae=>ae in N))throw new Error("sign() legacy options not supported");const{hash:j,randomBytes:M}=e;let{lowS:W,prehash:F,extraEntropy:$}=N;W==null&&(W=!0),x=re("msgHash",x),F&&(x=re("prehashed msgHash",j(x)));const ie=_(x),Q=f(A),he=[P(Q),P(ie)];if($!=null){const ae=$===!0?M(n.BYTES):$;he.push(re("extraEntropy",ae))}const ke=Ke(...he),be=ie;function Ge(ae){const Se=S(ae);if(!h(Se))return;const gt=a(Se),Ae=l.BASE.multiply(Se).toAffine(),le=c(Ae.x);if(le===ve)return;const Be=c(gt*c(be+le*Q));if(Be===ve)return;let Me=(Ae.x===le?0:2)|Number(Ae.y&fe),qe=Be;return W&&w(Be)&&(qe=b(Be),Me^=1),new p(le,qe,Me)}return{seed:ke,k2sig:Ge}}const q={lowS:e.lowS,prehash:!1},Y={lowS:e.lowS,prehash:!1};function K(x,A,N=q){const{seed:j,k2sig:M}=L(x,A,N),W=e;return or(W.hash.outputLen,W.nByteLength,W.hmac)(j,M)}l.BASE._setWindowSize(8);function D(x,A,N,j=Y){var Ae;const M=x;if(A=re("msgHash",A),N=re("publicKey",N),"strict"in j)throw new Error("options.strict was renamed to lowS");const{lowS:W,prehash:F}=j;let $,ie;try{if(typeof M=="string"||M instanceof Uint8Array)try{$=p.fromDER(M)}catch(le){if(!(le instanceof De.Err))throw le;$=p.fromCompact(M)}else if(typeof M=="object"&&typeof M.r=="bigint"&&typeof M.s=="bigint"){const{r:le,s:Be}=M;$=new p(le,Be)}else throw new Error("PARSE");ie=l.fromHex(N)}catch(le){if(le.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(W&&$.hasHighS())return!1;F&&(A=e.hash(A));const{r:Q,s:he}=$,ke=_(A),be=a(he),Ge=c(ke*be),ae=c(Q*be),Se=(Ae=l.BASE.multiplyAndAddUnsafe(ie,Ge,ae))==null?void 0:Ae.toAffine();return Se?c(Se.x)===Q:!1}return{CURVE:e,getPublicKey:k,getSharedSecret:T,sign:K,verify:D,ProjectivePoint:l,Signature:p,utils:y}}let dr=class extends Xn{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,$o(e);const r=tn(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,i=new Uint8Array(o);i.set(r.length>o?e.create().update(r).digest():r);for(let s=0;s<i.length;s++)i[s]^=54;this.iHash.update(i),this.oHash=e.create();for(let s=0;s<i.length;s++)i[s]^=106;this.oHash.update(i),i.fill(0)}update(e){return Et(this),this.iHash.update(e),this}digestInto(e){Et(this),Jn(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:o,destroyed:i,blockLen:s,outputLen:c}=this;return e=e,e.finished=o,e.destroyed=i,e.blockLen=s,e.outputLen=c,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const hr=(t,e,n)=>new dr(t,e).update(n).digest();hr.create=(t,e)=>new dr(t,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Ai(t){return{hash:t,hmac:(e,...n)=>hr(t,e,Wo(...n)),randomBytes:er}}function Bi(t,e){const n=r=>Si({...t,...Ai(r)});return Object.freeze({...n(e),create:n})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const St=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),At=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),br=BigInt(1),Bt=BigInt(2),gr=(t,e)=>(t+e/Bt)/e;function pr(t){const e=St,n=BigInt(3),r=BigInt(6),o=BigInt(11),i=BigInt(22),s=BigInt(23),c=BigInt(44),a=BigInt(88),l=t*t*t%e,f=l*l*t%e,u=ue(f,n,e)*f%e,h=ue(u,n,e)*f%e,d=ue(h,Bt,e)*l%e,w=ue(d,o,e)*d%e,b=ue(w,i,e)*w%e,g=ue(b,c,e)*b%e,p=ue(g,a,e)*g%e,y=ue(p,c,e)*b%e,k=ue(y,n,e)*f%e,C=ue(k,s,e)*w%e,T=ue(C,r,e)*l%e,S=ue(T,Bt,e);if(!dn.eql(dn.sqr(S),t))throw new Error("Cannot find square root");return S}const dn=pi(St,void 0,void 0,{sqrt:pr}),It=Bi({a:BigInt(0),b:BigInt(7),Fp:dn,n:At,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=At,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-br*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,s=BigInt("0x100000000000000000000000000000000"),c=gr(i*t,e),a=gr(-r*t,e);let l=ne(t-c*n-a*o,e),f=ne(-c*r-a*i,e);const u=l>s,h=f>s;if(u&&(l=e-l),h&&(f=e-f),l>s||f>s)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:u,k1:l,k2neg:h,k2:f}}}},nn),Ot=BigInt(0),wr=t=>typeof t=="bigint"&&Ot<t&&t<St,Ii=t=>typeof t=="bigint"&&Ot<t&&t<At,yr={};function Tt(t,...e){let n=yr[t];if(n===void 0){const r=nn(Uint8Array.from(t,o=>o.charCodeAt(0)));n=Ke(r,r),yr[t]=n}return nn(Ke(n,...e))}const hn=t=>t.toRawBytes(!0).slice(1),bn=t=>Ne(t,32),gn=t=>ne(t,St),ht=t=>ne(t,At),pn=It.ProjectivePoint,Oi=(t,e,n)=>pn.BASE.multiplyAndAddUnsafe(t,e,n);function wn(t){let e=It.utils.normPrivateKeyToScalar(t),n=pn.fromPrivateKey(e);return{scalar:n.hasEvenY()?e:ht(-e),bytes:hn(n)}}function mr(t){if(!wr(t))throw new Error("bad x: need 0 < x < p");const e=gn(t*t),n=gn(e*t+BigInt(7));let r=pr(n);r%Bt!==Ot&&(r=gn(-r));const o=new pn(t,r,br);return o.assertValidity(),o}function vr(...t){return ht(se(Tt("BIP0340/challenge",...t)))}function Ti(t){return wn(t).bytes}function Pi(t,e,n=er(32)){const r=re("message",t),{bytes:o,scalar:i}=wn(e),s=re("auxRand",n,32),c=bn(i^se(Tt("BIP0340/aux",s))),a=Tt("BIP0340/nonce",c,o,r),l=ht(se(a));if(l===Ot)throw new Error("sign failed: k is zero");const{bytes:f,scalar:u}=wn(l),h=vr(f,o,r),d=new Uint8Array(64);if(d.set(f,0),d.set(bn(ht(u+h*i)),32),!xr(d,r,o))throw new Error("sign: Invalid signature produced");return d}function xr(t,e,n){const r=re("signature",t,64),o=re("message",e),i=re("publicKey",n,32);try{const s=mr(se(i)),c=se(r.subarray(0,32));if(!wr(c))return!1;const a=se(r.subarray(32,64));if(!Ii(a))return!1;const l=vr(bn(c),hn(s),o),f=Oi(s,a,ht(-l));return!(!f||!f.hasEvenY()||f.toAffine().x!==c)}catch{return!1}}const oe={getPublicKey:Ti,sign:Pi,verify:xr,utils:{randomPrivateKey:It.utils.randomPrivateKey,lift_x:mr,pointToBytes:hn,numberToBytesBE:Ne,bytesToNumberBE:se,taggedHash:Tt,mod:ne}};function yn(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Ni(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}function Er(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function Ci(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");yn(t.outputLen),yn(t.blockLen)}function Li(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Ri(t,e){Er(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const me={number:yn,bool:Ni,bytes:Er,hash:Ci,exists:Li,output:Ri};function Hi(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),c=Number(n&i),a=r?4:0,l=r?0:4;t.setUint32(e+a,s,r),t.setUint32(e+l,c,r)}class Ui extends Gn{constructor(e,n,r,o){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Jt(this.buffer)}update(e){me.exists(this);const{view:n,buffer:r,blockLen:o}=this;e=ft(e);const i=e.length;for(let s=0;s<i;){const c=Math.min(o-this.pos,i-s);if(c===o){const a=Jt(e);for(;o<=i-s;s+=o)this.process(a,s);continue}r.set(e.subarray(s,s+c),this.pos),this.pos+=c,s+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){me.exists(this),me.output(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:o,isLE:i}=this;let{pos:s}=this;n[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>o-s&&(this.process(r,0),s=0);for(let u=s;u<o;u++)n[u]=0;Hi(r,o-8,BigInt(this.length*8),i),this.process(r,0);const c=Jt(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=a/4,f=this.get();if(l>f.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<l;u++)c.setUint32(4*u,f[u],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:o,finished:i,destroyed:s,pos:c}=this;return e.length=o,e.pos=c,e.finished=i,e.destroyed=s,o%n&&e.buffer.set(r),e}}const Mi=(t,e,n)=>t&e^~t&n,qi=(t,e,n)=>t&e^t&n^e&n,ji=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ce=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Le=new Uint32Array(64);class _r extends Ui{constructor(){super(64,32,8,!1),this.A=Ce[0]|0,this.B=Ce[1]|0,this.C=Ce[2]|0,this.D=Ce[3]|0,this.E=Ce[4]|0,this.F=Ce[5]|0,this.G=Ce[6]|0,this.H=Ce[7]|0}get(){const{A:e,B:n,C:r,D:o,E:i,F:s,G:c,H:a}=this;return[e,n,r,o,i,s,c,a]}set(e,n,r,o,i,s,c,a){this.A=e|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=i|0,this.F=s|0,this.G=c|0,this.H=a|0}process(e,n){for(let u=0;u<16;u++,n+=4)Le[u]=e.getUint32(n,!1);for(let u=16;u<64;u++){const h=Le[u-15],d=Le[u-2],w=we(h,7)^we(h,18)^h>>>3,b=we(d,17)^we(d,19)^d>>>10;Le[u]=b+Le[u-7]+w+Le[u-16]|0}let{A:r,B:o,C:i,D:s,E:c,F:a,G:l,H:f}=this;for(let u=0;u<64;u++){const h=we(c,6)^we(c,11)^we(c,25),d=f+h+Mi(c,a,l)+ji[u]+Le[u]|0,b=(we(r,2)^we(r,13)^we(r,22))+qi(r,o,i)|0;f=l,l=a,a=c,c=s+d|0,s=i,i=o,o=r,r=d+b|0}r=r+this.A|0,o=o+this.B|0,i=i+this.C|0,s=s+this.D|0,c=c+this.E|0,a=a+this.F|0,l=l+this.G|0,f=f+this.H|0,this.set(r,o,i,s,c,a,l,f)}roundClean(){Le.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class $i extends _r{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const tt=Yn(()=>new _r);Yn(()=>new $i);var nt=Symbol("verified"),zi=t=>t instanceof Object;function Ki(t){if(!zi(t)||typeof t.kind!="number"||typeof t.content!="string"||typeof t.created_at!="number"||typeof t.pubkey!="string"||!t.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(t.tags))return!1;for(let e=0;e<t.tags.length;e++){let n=t.tags[e];if(!Array.isArray(n))return!1;for(let r=0;r<n.length;r++)if(typeof n[r]=="object")return!1}return!0}new TextDecoder("utf-8");var Wi=new TextEncoder,Di=class{generateSecretKey(){return oe.utils.randomPrivateKey()}getPublicKey(e){return ce(oe.getPublicKey(e))}finalizeEvent(e,n){const r=e;return r.pubkey=ce(oe.getPublicKey(n)),r.id=mn(r),r.sig=ce(oe.sign(mn(r),n)),r[nt]=!0,r}verifyEvent(e){if(typeof e[nt]=="boolean")return e[nt];const n=mn(e);if(n!==e.id)return e[nt]=!1,!1;try{const r=oe.verify(e.sig,n,e.pubkey);return e[nt]=r,r}catch{return e[nt]=!1,!1}}};function Vi(t){if(!Ki(t))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content])}function mn(t){let e=tt(Wi.encode(Vi(t)));return ce(e)}var Pt=new Di,Fi=Pt.generateSecretKey,kr=Pt.getPublicKey;Pt.finalizeEvent,Pt.verifyEvent;var Ve=Symbol("verified"),Gi=t=>t instanceof Object;function Yi(t){if(!Gi(t)||typeof t.kind!="number"||typeof t.content!="string"||typeof t.created_at!="number"||typeof t.pubkey!="string"||!t.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(t.tags))return!1;for(let e=0;e<t.tags.length;e++){let n=t.tags[e];if(!Array.isArray(n))return!1;for(let r=0;r<n.length;r++)if(typeof n[r]=="object")return!1}return!0}new TextDecoder("utf-8");var Zi=new TextEncoder;function rt(t){t.indexOf("://")===-1&&(t="wss://"+t);let e=new URL(t);return e.pathname=e.pathname.replace(/\/+/g,"/"),e.pathname.endsWith("/")&&(e.pathname=e.pathname.slice(0,-1)),(e.port==="80"&&e.protocol==="ws:"||e.port==="443"&&e.protocol==="wss:")&&(e.port=""),e.searchParams.sort(),e.hash="",e.toString()}var Ji=class{constructor(e){v(this,"value");v(this,"next",null);v(this,"prev",null);this.value=e}},Qi=class{constructor(){v(this,"first");v(this,"last");this.first=null,this.last=null}enqueue(e){const n=new Ji(e);return this.last?this.last===this.first?(this.last=n,this.last.prev=this.first,this.first.next=n):(n.prev=this.last,this.last.next=n,this.last=n):(this.first=n,this.last=n),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){const n=this.first;return this.first=null,this.last=null,n.value}const e=this.first;return this.first=e.next,e.value}},Xi=class{generateSecretKey(){return oe.utils.randomPrivateKey()}getPublicKey(e){return ce(oe.getPublicKey(e))}finalizeEvent(e,n){const r=e;return r.pubkey=ce(oe.getPublicKey(n)),r.id=vn(r),r.sig=ce(oe.sign(vn(r),n)),r[Ve]=!0,r}verifyEvent(e){if(typeof e[Ve]=="boolean")return e[Ve];const n=vn(e);if(n!==e.id)return e[Ve]=!1,!1;try{const r=oe.verify(e.sig,n,e.pubkey);return e[Ve]=r,r}catch{return e[Ve]=!1,!1}}};function es(t){if(!Yi(t))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content])}function vn(t){let e=tt(Zi.encode(es(t)));return ce(e)}var Nt=new Xi;Nt.generateSecretKey,Nt.getPublicKey,Nt.finalizeEvent;var ts=Nt.verifyEvent,ns=22242;function rs(t,e){if(t.ids&&t.ids.indexOf(e.id)===-1||t.kinds&&t.kinds.indexOf(e.kind)===-1||t.authors&&t.authors.indexOf(e.pubkey)===-1)return!1;for(let n in t)if(n[0]==="#"){let r=n.slice(1),o=t[`#${r}`];if(o&&!e.tags.find(([i,s])=>i===n.slice(1)&&o.indexOf(s)!==-1))return!1}return!(t.since&&e.created_at<t.since||t.until&&e.created_at>t.until)}function os(t,e){for(let n=0;n<t.length;n++)if(rs(t[n],e))return!0;return!1}function is(t,e){let n=e.length+3,r=t.indexOf(`"${e}":`)+n,o=t.slice(r).indexOf('"')+r+1;return t.slice(o,o+64)}function ss(t){let e=t.slice(0,22).indexOf('"EVENT"');if(e===-1)return null;let n=t.slice(e+7+1).indexOf('"');if(n===-1)return null;let r=e+7+1+n,o=t.slice(r+1,80).indexOf('"');if(o===-1)return null;let i=r+1+o;return t.slice(r+1,i)}function cs(t,e){return{kind:ns,created_at:Math.floor(Date.now()/1e3),tags:[["relay",t],["challenge",e]],content:""}}async function as(){return new Promise(t=>{const e=new MessageChannel,n=()=>{e.port1.removeEventListener("message",n),t()};e.port1.addEventListener("message",n),e.port2.postMessage(0),e.port1.start()})}var ls=t=>(t[Ve]=!0,!0),Sr=class{constructor(e,n){v(this,"url");v(this,"_connected",!1);v(this,"onclose",null);v(this,"onnotice",e=>console.debug(`NOTICE from ${this.url}: ${e}`));v(this,"_onauth",null);v(this,"baseEoseTimeout",4400);v(this,"connectionTimeout",4400);v(this,"publishTimeout",4400);v(this,"openSubs",new Map);v(this,"connectionTimeoutHandle");v(this,"connectionPromise");v(this,"openCountRequests",new Map);v(this,"openEventPublishes",new Map);v(this,"ws");v(this,"incomingMessageQueue",new Qi);v(this,"queueRunning",!1);v(this,"challenge");v(this,"authPromise");v(this,"serial",0);v(this,"verifyEvent");v(this,"_WebSocket");this.url=rt(e),this.verifyEvent=n.verifyEvent,this._WebSocket=n.websocketImplementation||WebSocket}static async connect(e,n){const r=new Sr(e,n);return await r.connect(),r}closeAllSubscriptions(e){for(let[n,r]of this.openSubs)r.close(e);this.openSubs.clear();for(let[n,r]of this.openEventPublishes)r.reject(new Error(e));this.openEventPublishes.clear();for(let[n,r]of this.openCountRequests)r.reject(new Error(e));this.openCountRequests.clear()}get connected(){return this._connected}async connect(){return this.connectionPromise?this.connectionPromise:(this.challenge=void 0,this.authPromise=void 0,this.connectionPromise=new Promise((e,n)=>{this.connectionTimeoutHandle=setTimeout(()=>{var r;n("connection timed out"),this.connectionPromise=void 0,(r=this.onclose)==null||r.call(this),this.closeAllSubscriptions("relay connection timed out")},this.connectionTimeout);try{this.ws=new this._WebSocket(this.url)}catch(r){n(r);return}this.ws.onopen=()=>{clearTimeout(this.connectionTimeoutHandle),this._connected=!0,e()},this.ws.onerror=r=>{var o;n(r.message||"websocket error"),this._connected&&(this._connected=!1,this.connectionPromise=void 0,(o=this.onclose)==null||o.call(this),this.closeAllSubscriptions("relay connection errored"))},this.ws.onclose=async()=>{var r;this._connected&&(this._connected=!1,this.connectionPromise=void 0,(r=this.onclose)==null||r.call(this),this.closeAllSubscriptions("relay connection closed"))},this.ws.onmessage=this._onmessage.bind(this)}),this.connectionPromise)}async runQueue(){for(this.queueRunning=!0;this.handleNext()!==!1;)await as();this.queueRunning=!1}handleNext(){var r,o,i;const e=this.incomingMessageQueue.dequeue();if(!e)return!1;const n=ss(e);if(n){const s=this.openSubs.get(n);if(!s)return;const c=is(e,"id"),a=(r=s.alreadyHaveEvent)==null?void 0:r.call(s,c);if((o=s.receivedEvent)==null||o.call(s,this,c),a)return}try{let s=JSON.parse(e);switch(s[0]){case"EVENT":{const c=this.openSubs.get(s[1]),a=s[2];this.verifyEvent(a)&&os(c.filters,a)&&c.onevent(a);return}case"COUNT":{const c=s[1],a=s[2],l=this.openCountRequests.get(c);l&&(l.resolve(a.count),this.openCountRequests.delete(c));return}case"EOSE":{const c=this.openSubs.get(s[1]);if(!c)return;c.receivedEose();return}case"OK":{const c=s[1],a=s[2],l=s[3],f=this.openEventPublishes.get(c);f&&(clearTimeout(f.timeout),a?f.resolve(l):f.reject(new Error(l)),this.openEventPublishes.delete(c));return}case"CLOSED":{const c=s[1],a=this.openSubs.get(c);if(!a)return;a.closed=!0,a.close(s[2]);return}case"NOTICE":this.onnotice(s[1]);return;case"AUTH":{this.challenge=s[1],this.authPromise=void 0,(i=this._onauth)==null||i.call(this,s[1]);return}}}catch{return}}async send(e){if(!this.connectionPromise)throw new Error("sending on closed connection");this.connectionPromise.then(()=>{var n;(n=this.ws)==null||n.send(e)})}async auth(e){if(!this.challenge)throw new Error("can't perform auth, no challenge was received");if(this.authPromise)return this.authPromise;const n=await e(cs(this.url,this.challenge));return this.authPromise=new Promise((r,o)=>{const i=setTimeout(()=>{const s=this.openEventPublishes.get(n.id);s&&(s.reject(new Error("auth timed out")),this.openEventPublishes.delete(n.id))},this.publishTimeout);this.openEventPublishes.set(n.id,{resolve:r,reject:o,timeout:i})}),this.send('["AUTH",'+JSON.stringify(n)+"]"),this.authPromise}async publish(e){const n=new Promise((r,o)=>{const i=setTimeout(()=>{const s=this.openEventPublishes.get(e.id);s&&(s.reject(new Error("publish timed out")),this.openEventPublishes.delete(e.id))},this.publishTimeout);this.openEventPublishes.set(e.id,{resolve:r,reject:o,timeout:i})});return this.send('["EVENT",'+JSON.stringify(e)+"]"),n}async count(e,n){this.serial++;const r=(n==null?void 0:n.id)||"count:"+this.serial,o=new Promise((i,s)=>{this.openCountRequests.set(r,{resolve:i,reject:s})});return this.send('["COUNT","'+r+'",'+JSON.stringify(e).substring(1)),o}subscribe(e,n){const r=this.prepareSubscription(e,n);return r.fire(),r}prepareSubscription(e,n){this.serial++;const r=n.id||(n.label?n.label+":":"sub:")+this.serial,o=new us(this,r,e,n);return this.openSubs.set(r,o),o}close(){var e;this.closeAllSubscriptions("relay connection closed by us"),this._connected=!1,(e=this.ws)==null||e.close()}_onmessage(e){this.incomingMessageQueue.enqueue(e.data),this.queueRunning||this.runQueue()}},us=class{constructor(e,n,r,o){v(this,"relay");v(this,"id");v(this,"closed",!1);v(this,"eosed",!1);v(this,"filters");v(this,"alreadyHaveEvent");v(this,"receivedEvent");v(this,"onevent");v(this,"oneose");v(this,"onclose");v(this,"eoseTimeout");v(this,"eoseTimeoutHandle");this.relay=e,this.filters=r,this.id=n,this.alreadyHaveEvent=o.alreadyHaveEvent,this.receivedEvent=o.receivedEvent,this.eoseTimeout=o.eoseTimeout||e.baseEoseTimeout,this.oneose=o.oneose,this.onclose=o.onclose,this.onevent=o.onevent||(i=>{console.warn(`onevent() callback not defined for subscription '${this.id}' in relay ${this.relay.url}. event received:`,i)})}fire(){this.relay.send('["REQ","'+this.id+'",'+JSON.stringify(this.filters).substring(1)),this.eoseTimeoutHandle=setTimeout(this.receivedEose.bind(this),this.eoseTimeout)}receivedEose(){var e;this.eosed||(clearTimeout(this.eoseTimeoutHandle),this.eosed=!0,(e=this.oneose)==null||e.call(this))}close(e="closed by caller"){var n;!this.closed&&this.relay.connected&&(this.relay.send('["CLOSE",'+JSON.stringify(this.id)+"]"),this.closed=!0),this.relay.openSubs.delete(this.id),(n=this.onclose)==null||n.call(this,e)}},fs=class{constructor(e){v(this,"relays",new Map);v(this,"seenOn",new Map);v(this,"trackRelays",!1);v(this,"verifyEvent");v(this,"trustedRelayURLs",new Set);v(this,"_WebSocket");this.verifyEvent=e.verifyEvent,this._WebSocket=e.websocketImplementation}async ensureRelay(e,n){e=rt(e);let r=this.relays.get(e);return r||(r=new Sr(e,{verifyEvent:this.trustedRelayURLs.has(e)?ls:this.verifyEvent,websocketImplementation:this._WebSocket}),n!=null&&n.connectionTimeout&&(r.connectionTimeout=n.connectionTimeout),this.relays.set(e,r)),await r.connect(),r}close(e){e.map(rt).forEach(n=>{var r;(r=this.relays.get(n))==null||r.close()})}subscribe(e,n,r){return this.subscribeMap(e.map(o=>({url:o,filter:n})),r)}subscribeMany(e,n,r){return this.subscribeMap(e.flatMap(o=>n.map(i=>({url:o,filter:i}))),r)}subscribeMap(e,n){this.trackRelays&&(n.receivedEvent=(u,h)=>{let d=this.seenOn.get(h);d||(d=new Set,this.seenOn.set(h,d)),d.add(u)});const r=new Set,o=[],i=[];let s=u=>{var h;i[u]||(i[u]=!0,i.filter(d=>d).length===e.length&&((h=n.oneose)==null||h.call(n),s=()=>{}))};const c=[];let a=(u,h)=>{var d;c[u]||(s(u),c[u]=h,c.filter(w=>w).length===e.length&&((d=n.onclose)==null||d.call(n,c),a=()=>{}))};const l=u=>{var d;if((d=n.alreadyHaveEvent)!=null&&d.call(n,u))return!0;const h=r.has(u);return r.add(u),h},f=Promise.all(e.map(async({url:u,filter:h},d)=>{u=rt(u);let w;try{w=await this.ensureRelay(u,{connectionTimeout:n.maxWait?Math.max(n.maxWait*.8,n.maxWait-1e3):void 0})}catch(g){a(d,(g==null?void 0:g.message)||String(g));return}let b=w.subscribe([h],{...n,oneose:()=>s(d),onclose:g=>{g.startsWith("auth-required:")&&n.doauth?w.auth(n.doauth).then(()=>{w.subscribe([h],{...n,oneose:()=>s(d),onclose:p=>{a(d,p)},alreadyHaveEvent:l,eoseTimeout:n.maxWait})}).catch(p=>{a(d,`auth was required and attempted, but failed with: ${p}`)}):a(d,g)},alreadyHaveEvent:l,eoseTimeout:n.maxWait});o.push(b)}));return{async close(){await f,o.forEach(u=>{u.close()})}}}subscribeManyMap(e,n){this.trackRelays&&(n.receivedEvent=(h,d)=>{let w=this.seenOn.get(d);w||(w=new Set,this.seenOn.set(d,w)),w.add(h)});const r=new Set,o=[],i=Object.keys(e).length,s=[];let c=h=>{var d;s[h]||(s[h]=!0,s.filter(w=>w).length===i&&((d=n.oneose)==null||d.call(n),c=()=>{}))};const a=[];let l=(h,d)=>{var w;a[h]||(c(h),a[h]=d,a.filter(b=>b).length===i&&((w=n.onclose)==null||w.call(n,a),l=()=>{}))};const f=h=>{var w;if((w=n.alreadyHaveEvent)!=null&&w.call(n,h))return!0;const d=r.has(h);return r.add(h),d},u=Promise.all(Object.entries(e).map(async(h,d,w)=>{if(w.indexOf(h)!==d){l(d,"duplicate url");return}let[b,g]=h;b=rt(b);let p;try{p=await this.ensureRelay(b,{connectionTimeout:n.maxWait?Math.max(n.maxWait*.8,n.maxWait-1e3):void 0})}catch(k){l(d,(k==null?void 0:k.message)||String(k));return}let y=p.subscribe(g,{...n,oneose:()=>c(d),onclose:k=>{k.startsWith("auth-required:")&&n.doauth?p.auth(n.doauth).then(()=>{p.subscribe(g,{...n,oneose:()=>c(d),onclose:C=>{l(d,C)},alreadyHaveEvent:f,eoseTimeout:n.maxWait})}).catch(C=>{l(d,`auth was required and attempted, but failed with: ${C}`)}):l(d,k)},alreadyHaveEvent:f,eoseTimeout:n.maxWait});o.push(y)}));return{async close(){await u,o.forEach(h=>{h.close()})}}}subscribeEose(e,n,r){const o=this.subscribe(e,n,{...r,oneose(){o.close()}});return o}subscribeManyEose(e,n,r){const o=this.subscribeMany(e,n,{...r,oneose(){o.close()}});return o}async querySync(e,n,r){return new Promise(async o=>{const i=[];this.subscribeEose(e,n,{...r,onevent(s){i.push(s)},onclose(s){o(i)}})})}async get(e,n,r){n.limit=1;const o=await this.querySync(e,n,r);return o.sort((i,s)=>s.created_at-i.created_at),o[0]||null}publish(e,n){return e.map(rt).map(async(r,o,i)=>{if(i.indexOf(r)!==o)return Promise.reject("duplicate url");let s=await this.ensureRelay(r);return s.publish(n).then(c=>{if(this.trackRelays){let a=this.seenOn.get(n.id);a||(a=new Set,this.seenOn.set(n.id,a)),a.add(s)}return c})})}listConnectionStatus(){const e=new Map;return this.relays.forEach((n,r)=>e.set(r,n.connected)),e}destroy(){this.relays.forEach(e=>e.close()),this.relays=new Map}},Ar;try{Ar=WebSocket}catch{}var ds=class extends fs{constructor(){super({verifyEvent:ts,websocketImplementation:Ar})}};function xn(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function Br(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function hs(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function Ct(t,...e){if(!hs(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */const Re=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4));if(!(new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68))throw new Error("Non little-endian hardware is not supported");function bs(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function gs(t,e){if(t.length!==e.length)return!1;let n=0;for(let r=0;r<t.length;r++)n|=t[r]^e[r];return n===0}const Ir=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),ps=Ir("expand 16-byte k"),ws=Ir("expand 32-byte k"),ys=Re(ps),Or=Re(ws);Or.slice();function G(t,e){return t<<e|t>>>32-e}function En(t){return t.byteOffset%4===0}const Lt=64,ms=16,Tr=2**32-1,Pr=new Uint32Array;function vs(t,e,n,r,o,i,s,c){const a=o.length,l=new Uint8Array(Lt),f=Re(l),u=En(o)&&En(i),h=u?Re(o):Pr,d=u?Re(i):Pr;for(let w=0;w<a;s++){if(t(e,n,r,f,s,c),s>=Tr)throw new Error("arx: counter overflow");const b=Math.min(Lt,a-w);if(u&&b===Lt){const g=w/4;if(w%4!==0)throw new Error("arx: invalid block position");for(let p=0,y;p<ms;p++)y=g+p,d[y]=h[y]^f[p];w+=Lt;continue}for(let g=0,p;g<b;g++)p=w+g,i[p]=o[p]^l[g];w+=b}}function xs(t,e){const{allowShortKeys:n,extendNonceFn:r,counterLength:o,counterRight:i,rounds:s}=bs({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return xn(o),xn(s),Br(i),Br(n),(c,a,l,f,u=0)=>{Ct(c),Ct(a),Ct(l);const h=l.length;if(f||(f=new Uint8Array(h)),Ct(f),xn(u),u<0||u>=Tr)throw new Error("arx: counter overflow");if(f.length<h)throw new Error(`arx: output (${f.length}) is shorter than data (${h})`);const d=[];let w=c.length,b,g;if(w===32)b=c.slice(),d.push(b),g=Or;else if(w===16&&n)b=new Uint8Array(32),b.set(c),b.set(c,16),g=ys,d.push(b);else throw new Error(`arx: invalid 32-byte key, got length=${w}`);En(a)||(a=a.slice(),d.push(a));const p=Re(b);if(r){if(a.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(g,p,Re(a.subarray(0,16)),p),a=a.subarray(16)}const y=16-o;if(y!==a.length)throw new Error(`arx: nonce must be ${y} or 16 bytes`);if(y!==12){const C=new Uint8Array(12);C.set(a,i?0:12-a.length),a=C,d.push(a)}const k=Re(a);for(vs(t,g,p,k,l,f,u,s);d.length>0;)d.pop().fill(0);return f}}function Es(t,e,n,r,o,i=20){let s=t[0],c=t[1],a=t[2],l=t[3],f=e[0],u=e[1],h=e[2],d=e[3],w=e[4],b=e[5],g=e[6],p=e[7],y=o,k=n[0],C=n[1],T=n[2],S=s,_=c,m=a,P=l,L=f,q=u,Y=h,K=d,D=w,x=b,A=g,N=p,j=y,M=k,W=C,F=T;for(let ie=0;ie<i;ie+=2)S=S+L|0,j=G(j^S,16),D=D+j|0,L=G(L^D,12),S=S+L|0,j=G(j^S,8),D=D+j|0,L=G(L^D,7),_=_+q|0,M=G(M^_,16),x=x+M|0,q=G(q^x,12),_=_+q|0,M=G(M^_,8),x=x+M|0,q=G(q^x,7),m=m+Y|0,W=G(W^m,16),A=A+W|0,Y=G(Y^A,12),m=m+Y|0,W=G(W^m,8),A=A+W|0,Y=G(Y^A,7),P=P+K|0,F=G(F^P,16),N=N+F|0,K=G(K^N,12),P=P+K|0,F=G(F^P,8),N=N+F|0,K=G(K^N,7),S=S+q|0,F=G(F^S,16),A=A+F|0,q=G(q^A,12),S=S+q|0,F=G(F^S,8),A=A+F|0,q=G(q^A,7),_=_+Y|0,j=G(j^_,16),N=N+j|0,Y=G(Y^N,12),_=_+Y|0,j=G(j^_,8),N=N+j|0,Y=G(Y^N,7),m=m+K|0,M=G(M^m,16),D=D+M|0,K=G(K^D,12),m=m+K|0,M=G(M^m,8),D=D+M|0,K=G(K^D,7),P=P+L|0,W=G(W^P,16),x=x+W|0,L=G(L^x,12),P=P+L|0,W=G(W^P,8),x=x+W|0,L=G(L^x,7);let $=0;r[$++]=s+S|0,r[$++]=c+_|0,r[$++]=a+m|0,r[$++]=l+P|0,r[$++]=f+L|0,r[$++]=u+q|0,r[$++]=h+Y|0,r[$++]=d+K|0,r[$++]=w+D|0,r[$++]=b+x|0,r[$++]=g+A|0,r[$++]=p+N|0,r[$++]=y+j|0,r[$++]=k+M|0,r[$++]=C+W|0,r[$++]=T+F|0}const Nr=xs(Es,{counterRight:!1,counterLength:4,allowShortKeys:!1});class Cr extends Gn{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,me.hash(e);const r=ft(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,i=new Uint8Array(o);i.set(r.length>o?e.create().update(r).digest():r);for(let s=0;s<i.length;s++)i[s]^=54;this.iHash.update(i),this.oHash=e.create();for(let s=0;s<i.length;s++)i[s]^=106;this.oHash.update(i),i.fill(0)}update(e){return me.exists(this),this.iHash.update(e),this}digestInto(e){me.exists(this),me.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:o,destroyed:i,blockLen:s,outputLen:c}=this;return e=e,e.finished=o,e.destroyed=i,e.blockLen=s,e.outputLen=c,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Rt=(t,e,n)=>new Cr(t,e).update(n).digest();Rt.create=(t,e)=>new Cr(t,e);function _s(t,e,n){return me.hash(t),Rt(t,ft(n),ft(e))}const _n=new Uint8Array([0]),Lr=new Uint8Array;function ks(t,e,n,r=32){if(me.hash(t),me.number(r),r>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");const o=Math.ceil(r/t.outputLen);n===void 0&&(n=Lr);const i=new Uint8Array(o*t.outputLen),s=Rt.create(t,e),c=s._cloneInto(),a=new Uint8Array(s.outputLen);for(let l=0;l<o;l++)_n[0]=l+1,c.update(l===0?Lr:a).update(n).update(_n).digestInto(a),i.set(a,t.outputLen*l),s._cloneInto(c);return s.destroy(),c.destroy(),a.fill(0),_n.fill(0),i.slice(0,r)}/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function ot(t){if(!Number.isSafeInteger(t))throw new Error(`Wrong integer: ${t}`)}function xe(...t){const e=(o,i)=>s=>o(i(s)),n=Array.from(t).reverse().reduce((o,i)=>o?e(o,i.encode):i.encode,void 0),r=t.reduce((o,i)=>o?e(o,i.decode):i.decode,void 0);return{encode:n,decode:r}}function Ee(t){return{encode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return e.map(n=>{if(ot(n),n<0||n>=t.length)throw new Error(`Digit index outside alphabet: ${n} (alphabet: ${t.length})`);return t[n]})},decode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="string")throw new Error("alphabet.decode input should be array of strings");return e.map(n=>{if(typeof n!="string")throw new Error(`alphabet.decode: not string element=${n}`);const r=t.indexOf(n);if(r===-1)throw new Error(`Unknown letter: "${n}". Allowed: ${t}`);return r})}}}function _e(t=""){if(typeof t!="string")throw new Error("join separator should be string");return{encode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="string")throw new Error("join.encode input should be array of strings");for(let n of e)if(typeof n!="string")throw new Error(`join.encode: non-string input=${n}`);return e.join(t)},decode:e=>{if(typeof e!="string")throw new Error("join.decode input should be string");return e.split(t)}}}function Ht(t,e="="){if(ot(t),typeof e!="string")throw new Error("padding chr should be string");return{encode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let r of n)if(typeof r!="string")throw new Error(`padding.encode: non-string input=${r}`);for(;n.length*t%8;)n.push(e);return n},decode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let o of n)if(typeof o!="string")throw new Error(`padding.decode: non-string input=${o}`);let r=n.length;if(r*t%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&n[r-1]===e;r--)if(!((r-1)*t%8))throw new Error("Invalid padding: string has too much padding");return n.slice(0,r)}}}function Rr(t){if(typeof t!="function")throw new Error("normalize fn should be function");return{encode:e=>e,decode:e=>t(e)}}function Hr(t,e,n){if(e<2)throw new Error(`convertRadix: wrong from=${e}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(t))throw new Error("convertRadix: data should be array");if(!t.length)return[];let r=0;const o=[],i=Array.from(t);for(i.forEach(s=>{if(ot(s),s<0||s>=e)throw new Error(`Wrong integer: ${s}`)});;){let s=0,c=!0;for(let a=r;a<i.length;a++){const l=i[a],f=e*s+l;if(!Number.isSafeInteger(f)||e*s/e!==s||f-l!==e*s)throw new Error("convertRadix: carry overflow");if(s=f%n,i[a]=Math.floor(f/n),!Number.isSafeInteger(i[a])||i[a]*n+s!==f)throw new Error("convertRadix: carry overflow");if(c)i[a]?c=!1:r=a;else continue}if(o.push(s),c)break}for(let s=0;s<t.length-1&&t[s]===0;s++)o.push(0);return o.reverse()}const Ur=(t,e)=>e?Ur(e,t%e):t,Ut=(t,e)=>t+(e-Ur(t,e));function kn(t,e,n,r){if(!Array.isArray(t))throw new Error("convertRadix2: data should be array");if(e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(Ut(e,n)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${n} carryBits=${Ut(e,n)}`);let o=0,i=0;const s=2**n-1,c=[];for(const a of t){if(ot(a),a>=2**e)throw new Error(`convertRadix2: invalid data word=${a} from=${e}`);if(o=o<<e|a,i+e>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${e}`);for(i+=e;i>=n;i-=n)c.push((o>>i-n&s)>>>0);o&=2**i-1}if(o=o<<n-i&s,!r&&i>=e)throw new Error("Excess padding");if(!r&&o)throw new Error(`Non-zero padding: ${o}`);return r&&i>0&&c.push(o>>>0),c}function Ss(t){return ot(t),{encode:e=>{if(!(e instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return Hr(Array.from(e),2**8,t)},decode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(Hr(e,t,2**8))}}}function He(t,e=!1){if(ot(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(Ut(8,t)>32||Ut(t,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!(n instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return kn(Array.from(n),8,t,!e)},decode:n=>{if(!Array.isArray(n)||n.length&&typeof n[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(kn(n,t,8,e))}}}function Mr(t){if(typeof t!="function")throw new Error("unsafeWrapper fn should be function");return function(...e){try{return t.apply(null,e)}catch{}}}const As=xe(He(4),Ee("0123456789ABCDEF"),_e("")),Bs=xe(He(5),Ee("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Ht(5),_e(""));xe(He(5),Ee("0123456789ABCDEFGHIJKLMNOPQRSTUV"),Ht(5),_e("")),xe(He(5),Ee("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),_e(""),Rr(t=>t.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")));const Sn=xe(He(6),Ee("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Ht(6),_e("")),Is=xe(He(6),Ee("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Ht(6),_e("")),An=t=>xe(Ss(58),Ee(t),_e("")),Bn=An("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");An("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),An("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const qr=[0,2,3,5,6,7,9,10,11],Os={encode(t){let e="";for(let n=0;n<t.length;n+=8){const r=t.subarray(n,n+8);e+=Bn.encode(r).padStart(qr[r.length],"1")}return e},decode(t){let e=[];for(let n=0;n<t.length;n+=11){const r=t.slice(n,n+11),o=qr.indexOf(r.length),i=Bn.decode(r);for(let s=0;s<i.length-o;s++)if(i[s]!==0)throw new Error("base58xmr: wrong padding");e=e.concat(Array.from(i.slice(i.length-o)))}return Uint8Array.from(e)}},In=xe(Ee("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),_e("")),jr=[996825010,642813549,513874426,1027748829,705979059];function bt(t){const e=t>>25;let n=(t&33554431)<<5;for(let r=0;r<jr.length;r++)(e>>r&1)===1&&(n^=jr[r]);return n}function $r(t,e,n=1){const r=t.length;let o=1;for(let i=0;i<r;i++){const s=t.charCodeAt(i);if(s<33||s>126)throw new Error(`Invalid prefix (${t})`);o=bt(o)^s>>5}o=bt(o);for(let i=0;i<r;i++)o=bt(o)^t.charCodeAt(i)&31;for(let i of e)o=bt(o)^i;for(let i=0;i<6;i++)o=bt(o);return o^=n,In.encode(kn([o%2**30],30,5,!1))}function zr(t){const e=t==="bech32"?1:734539939,n=He(5),r=n.decode,o=n.encode,i=Mr(r);function s(f,u,h=90){if(typeof f!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof f}`);if(!Array.isArray(u)||u.length&&typeof u[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof u}`);const d=f.length+7+u.length;if(h!==!1&&d>h)throw new TypeError(`Length ${d} exceeds limit ${h}`);return f=f.toLowerCase(),`${f}1${In.encode(u)}${$r(f,u,e)}`}function c(f,u=90){if(typeof f!="string")throw new Error(`bech32.decode input should be string, not ${typeof f}`);if(f.length<8||u!==!1&&f.length>u)throw new TypeError(`Wrong string length: ${f.length} (${f}). Expected (8..${u})`);const h=f.toLowerCase();if(f!==h&&f!==f.toUpperCase())throw new Error("String must be lowercase or uppercase");f=h;const d=f.lastIndexOf("1");if(d===0||d===-1)throw new Error('Letter "1" must be present between prefix and data only');const w=f.slice(0,d),b=f.slice(d+1);if(b.length<6)throw new Error("Data must be at least 6 characters long");const g=In.decode(b).slice(0,-6),p=$r(w,g,e);if(!b.endsWith(p))throw new Error(`Invalid checksum in ${f}: expected "${p}"`);return{prefix:w,words:g}}const a=Mr(c);function l(f){const{prefix:u,words:h}=c(f,!1);return{prefix:u,words:h,bytes:r(h)}}return{encode:s,decode:c,decodeToBytes:l,decodeUnsafe:a,fromWords:r,fromWordsUnsafe:i,toWords:o}}const Kr=zr("bech32");zr("bech32m");const Ts={encode:t=>new TextDecoder().decode(t),decode:t=>new TextEncoder().encode(t)},Ps=xe(He(4),Ee("0123456789abcdef"),_e(""),Rr(t=>{if(typeof t!="string"||t.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof t} with length ${t.length}`);return t.toLowerCase()}));`${Object.keys({utf8:Ts,hex:Ps,base16:As,base32:Bs,base64:Sn,base64url:Is,base58:Bn,base58xmr:Os}).join(", ")}`;var Fe=Symbol("verified"),Ns=t=>t instanceof Object;function Cs(t){if(!Ns(t)||typeof t.kind!="number"||typeof t.content!="string"||typeof t.created_at!="number"||typeof t.pubkey!="string"||!t.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(t.tags))return!1;for(let e=0;e<t.tags.length;e++){let n=t.tags[e];if(!Array.isArray(n))return!1;for(let r=0;r<n.length;r++)if(typeof n[r]=="object")return!1}return!0}var Ls=new TextDecoder("utf-8"),Wr=new TextEncoder;function it(t){t.indexOf("://")===-1&&(t="wss://"+t);let e=new URL(t);return e.pathname=e.pathname.replace(/\/+/g,"/"),e.pathname.endsWith("/")&&(e.pathname=e.pathname.slice(0,-1)),(e.port==="80"&&e.protocol==="ws:"||e.port==="443"&&e.protocol==="wss:")&&(e.port=""),e.searchParams.sort(),e.hash="",e.toString()}var Rs=class{constructor(t){v(this,"value");v(this,"next",null);v(this,"prev",null);this.value=t}},Hs=class{constructor(){v(this,"first");v(this,"last");this.first=null,this.last=null}enqueue(t){const e=new Rs(t);return this.last?this.last===this.first?(this.last=e,this.last.prev=this.first,this.first.next=e):(e.prev=this.last,this.last.next=e,this.last=e):(this.first=e,this.last=e),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){const e=this.first;return this.first=null,this.last=null,e.value}const t=this.first;return this.first=t.next,t.value}},Us=class{generateSecretKey(){return oe.utils.randomPrivateKey()}getPublicKey(t){return ce(oe.getPublicKey(t))}finalizeEvent(t,e){const n=t;return n.pubkey=ce(oe.getPublicKey(e)),n.id=On(n),n.sig=ce(oe.sign(On(n),e)),n[Fe]=!0,n}verifyEvent(t){if(typeof t[Fe]=="boolean")return t[Fe];const e=On(t);if(e!==t.id)return t[Fe]=!1,!1;try{const n=oe.verify(t.sig,e,t.pubkey);return t[Fe]=n,n}catch{return t[Fe]=!1,!1}}};function Ms(t){if(!Cs(t))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content])}function On(t){let e=tt(Wr.encode(Ms(t)));return ce(e)}var Mt=new Us;Mt.generateSecretKey;var qs=Mt.getPublicKey,js=Mt.finalizeEvent,Dr=Mt.verifyEvent,Vr=1,Fr=65535;function $s(t,e){const n=It.getSharedSecret(t,"02"+e).subarray(1,33);return _s(tt,n,"nip44-v2")}function Gr(t,e){const n=ks(tt,t,e,76);return{chacha_key:n.subarray(0,32),chacha_nonce:n.subarray(32,44),hmac_key:n.subarray(44,76)}}function Yr(t){if(!Number.isSafeInteger(t)||t<1)throw new Error("expected positive integer");if(t<=32)return 32;const e=1<<Math.floor(Math.log2(t-1))+1,n=e<=256?32:e/8;return n*(Math.floor((t-1)/n)+1)}function zs(t){if(!Number.isSafeInteger(t)||t<Vr||t>Fr)throw new Error("invalid plaintext size: must be between 1 and 65535 bytes");const e=new Uint8Array(2);return new DataView(e.buffer).setUint16(0,t,!1),e}function Ks(t){const e=Wr.encode(t),n=e.length,r=zs(n),o=new Uint8Array(Yr(n)-n);return Qt(r,e,o)}function Ws(t){const e=new DataView(t.buffer).getUint16(0),n=t.subarray(2,2+e);if(e<Vr||e>Fr||n.length!==e||t.length!==2+Yr(e))throw new Error("invalid padding");return Ls.decode(n)}function Zr(t,e,n){if(n.length!==32)throw new Error("AAD associated data must be 32 bytes");const r=Qt(n,e);return Rt(tt,t,r)}function Ds(t){if(typeof t!="string")throw new Error("payload must be a valid string");const e=t.length;if(e<132||e>87472)throw new Error("invalid payload length: "+e);if(t[0]==="#")throw new Error("unknown encryption version");let n;try{n=Sn.decode(t)}catch(i){throw new Error("invalid base64: "+i.message)}const r=n.length;if(r<99||r>65603)throw new Error("invalid data length: "+r);const o=n[0];if(o!==2)throw new Error("unknown encryption version "+o);return{nonce:n.subarray(1,33),ciphertext:n.subarray(33,-32),mac:n.subarray(-32)}}function Vs(t,e,n=jo(32)){const{chacha_key:r,chacha_nonce:o,hmac_key:i}=Gr(e,n),s=Ks(t),c=Nr(r,o,s),a=Zr(i,c,n);return Sn.encode(Qt(new Uint8Array([2]),n,c,a))}function Fs(t,e){const{nonce:n,ciphertext:r,mac:o}=Ds(t),{chacha_key:i,chacha_nonce:s,hmac_key:c}=Gr(e,n),a=Zr(c,r,n);if(!gs(a,o))throw new Error("invalid MAC");const l=Nr(i,s,r);return Ws(l)}var Gs=/^(?:([\w.+-]+)@)?([\w_-]+(\.[\w_-]+)+)$/,Ys;try{Ys=fetch}catch{}var Zs=22242,Jr=24133;function Js(t,e){if(t.ids&&t.ids.indexOf(e.id)===-1||t.kinds&&t.kinds.indexOf(e.kind)===-1||t.authors&&t.authors.indexOf(e.pubkey)===-1)return!1;for(let n in t)if(n[0]==="#"){let r=n.slice(1),o=t[`#${r}`];if(o&&!e.tags.find(([i,s])=>i===n.slice(1)&&o.indexOf(s)!==-1))return!1}return!(t.since&&e.created_at<t.since||t.until&&e.created_at>t.until)}function Qs(t,e){for(let n=0;n<t.length;n++)if(Js(t[n],e))return!0;return!1}function Xs(t,e){let n=e.length+3,r=t.indexOf(`"${e}":`)+n,o=t.slice(r).indexOf('"')+r+1;return t.slice(o,o+64)}function ec(t){let e=t.slice(0,22).indexOf('"EVENT"');if(e===-1)return null;let n=t.slice(e+7+1).indexOf('"');if(n===-1)return null;let r=e+7+1+n,o=t.slice(r+1,80).indexOf('"');if(o===-1)return null;let i=r+1+o;return t.slice(r+1,i)}function tc(t,e){return{kind:Zs,created_at:Math.floor(Date.now()/1e3),tags:[["relay",t],["challenge",e]],content:""}}async function nc(){return new Promise(t=>{const e=new MessageChannel,n=()=>{e.port1.removeEventListener("message",n),t()};e.port1.addEventListener("message",n),e.port2.postMessage(0),e.port1.start()})}var rc=t=>(t[Fe]=!0,!0),Qr=class{constructor(t,e){v(this,"url");v(this,"_connected",!1);v(this,"onclose",null);v(this,"onnotice",t=>console.debug(`NOTICE from ${this.url}: ${t}`));v(this,"_onauth",null);v(this,"baseEoseTimeout",4400);v(this,"connectionTimeout",4400);v(this,"publishTimeout",4400);v(this,"openSubs",new Map);v(this,"connectionTimeoutHandle");v(this,"connectionPromise");v(this,"openCountRequests",new Map);v(this,"openEventPublishes",new Map);v(this,"ws");v(this,"incomingMessageQueue",new Hs);v(this,"queueRunning",!1);v(this,"challenge");v(this,"authPromise");v(this,"serial",0);v(this,"verifyEvent");v(this,"_WebSocket");this.url=it(t),this.verifyEvent=e.verifyEvent,this._WebSocket=e.websocketImplementation||WebSocket}static async connect(t,e){const n=new Qr(t,e);return await n.connect(),n}closeAllSubscriptions(t){for(let[e,n]of this.openSubs)n.close(t);this.openSubs.clear();for(let[e,n]of this.openEventPublishes)n.reject(new Error(t));this.openEventPublishes.clear();for(let[e,n]of this.openCountRequests)n.reject(new Error(t));this.openCountRequests.clear()}get connected(){return this._connected}async connect(){return this.connectionPromise?this.connectionPromise:(this.challenge=void 0,this.authPromise=void 0,this.connectionPromise=new Promise((t,e)=>{this.connectionTimeoutHandle=setTimeout(()=>{var n;e("connection timed out"),this.connectionPromise=void 0,(n=this.onclose)==null||n.call(this),this.closeAllSubscriptions("relay connection timed out")},this.connectionTimeout);try{this.ws=new this._WebSocket(this.url)}catch(n){e(n);return}this.ws.onopen=()=>{clearTimeout(this.connectionTimeoutHandle),this._connected=!0,t()},this.ws.onerror=n=>{var r;e(n.message||"websocket error"),this._connected&&(this._connected=!1,this.connectionPromise=void 0,(r=this.onclose)==null||r.call(this),this.closeAllSubscriptions("relay connection errored"))},this.ws.onclose=async()=>{var n;this._connected&&(this._connected=!1,this.connectionPromise=void 0,(n=this.onclose)==null||n.call(this),this.closeAllSubscriptions("relay connection closed"))},this.ws.onmessage=this._onmessage.bind(this)}),this.connectionPromise)}async runQueue(){for(this.queueRunning=!0;this.handleNext()!==!1;)await nc();this.queueRunning=!1}handleNext(){var n,r,o;const t=this.incomingMessageQueue.dequeue();if(!t)return!1;const e=ec(t);if(e){const i=this.openSubs.get(e);if(!i)return;const s=Xs(t,"id"),c=(n=i.alreadyHaveEvent)==null?void 0:n.call(i,s);if((r=i.receivedEvent)==null||r.call(i,this,s),c)return}try{let i=JSON.parse(t);switch(i[0]){case"EVENT":{const s=this.openSubs.get(i[1]),c=i[2];this.verifyEvent(c)&&Qs(s.filters,c)&&s.onevent(c);return}case"COUNT":{const s=i[1],c=i[2],a=this.openCountRequests.get(s);a&&(a.resolve(c.count),this.openCountRequests.delete(s));return}case"EOSE":{const s=this.openSubs.get(i[1]);if(!s)return;s.receivedEose();return}case"OK":{const s=i[1],c=i[2],a=i[3],l=this.openEventPublishes.get(s);l&&(clearTimeout(l.timeout),c?l.resolve(a):l.reject(new Error(a)),this.openEventPublishes.delete(s));return}case"CLOSED":{const s=i[1],c=this.openSubs.get(s);if(!c)return;c.closed=!0,c.close(i[2]);return}case"NOTICE":this.onnotice(i[1]);return;case"AUTH":{this.challenge=i[1],this.authPromise=void 0,(o=this._onauth)==null||o.call(this,i[1]);return}}}catch{return}}async send(t){if(!this.connectionPromise)throw new Error("sending on closed connection");this.connectionPromise.then(()=>{var e;(e=this.ws)==null||e.send(t)})}async auth(t){if(!this.challenge)throw new Error("can't perform auth, no challenge was received");if(this.authPromise)return this.authPromise;const e=await t(tc(this.url,this.challenge));return this.authPromise=new Promise((n,r)=>{const o=setTimeout(()=>{const i=this.openEventPublishes.get(e.id);i&&(i.reject(new Error("auth timed out")),this.openEventPublishes.delete(e.id))},this.publishTimeout);this.openEventPublishes.set(e.id,{resolve:n,reject:r,timeout:o})}),this.send('["AUTH",'+JSON.stringify(e)+"]"),this.authPromise}async publish(t){const e=new Promise((n,r)=>{const o=setTimeout(()=>{const i=this.openEventPublishes.get(t.id);i&&(i.reject(new Error("publish timed out")),this.openEventPublishes.delete(t.id))},this.publishTimeout);this.openEventPublishes.set(t.id,{resolve:n,reject:r,timeout:o})});return this.send('["EVENT",'+JSON.stringify(t)+"]"),e}async count(t,e){this.serial++;const n=(e==null?void 0:e.id)||"count:"+this.serial,r=new Promise((o,i)=>{this.openCountRequests.set(n,{resolve:o,reject:i})});return this.send('["COUNT","'+n+'",'+JSON.stringify(t).substring(1)),r}subscribe(t,e){const n=this.prepareSubscription(t,e);return n.fire(),n}prepareSubscription(t,e){this.serial++;const n=e.id||(e.label?e.label+":":"sub:")+this.serial,r=new oc(this,n,t,e);return this.openSubs.set(n,r),r}close(){var t;this.closeAllSubscriptions("relay connection closed by us"),this._connected=!1,(t=this.ws)==null||t.close()}_onmessage(t){this.incomingMessageQueue.enqueue(t.data),this.queueRunning||this.runQueue()}},oc=class{constructor(t,e,n,r){v(this,"relay");v(this,"id");v(this,"closed",!1);v(this,"eosed",!1);v(this,"filters");v(this,"alreadyHaveEvent");v(this,"receivedEvent");v(this,"onevent");v(this,"oneose");v(this,"onclose");v(this,"eoseTimeout");v(this,"eoseTimeoutHandle");this.relay=t,this.filters=n,this.id=e,this.alreadyHaveEvent=r.alreadyHaveEvent,this.receivedEvent=r.receivedEvent,this.eoseTimeout=r.eoseTimeout||t.baseEoseTimeout,this.oneose=r.oneose,this.onclose=r.onclose,this.onevent=r.onevent||(o=>{console.warn(`onevent() callback not defined for subscription '${this.id}' in relay ${this.relay.url}. event received:`,o)})}fire(){this.relay.send('["REQ","'+this.id+'",'+JSON.stringify(this.filters).substring(1)),this.eoseTimeoutHandle=setTimeout(this.receivedEose.bind(this),this.eoseTimeout)}receivedEose(){var t;this.eosed||(clearTimeout(this.eoseTimeoutHandle),this.eosed=!0,(t=this.oneose)==null||t.call(this))}close(t="closed by caller"){var e;!this.closed&&this.relay.connected&&(this.relay.send('["CLOSE",'+JSON.stringify(this.id)+"]"),this.closed=!0),this.relay.openSubs.delete(this.id),(e=this.onclose)==null||e.call(this,t)}},ic=class{constructor(t){v(this,"relays",new Map);v(this,"seenOn",new Map);v(this,"trackRelays",!1);v(this,"verifyEvent");v(this,"trustedRelayURLs",new Set);v(this,"_WebSocket");this.verifyEvent=t.verifyEvent,this._WebSocket=t.websocketImplementation}async ensureRelay(t,e){t=it(t);let n=this.relays.get(t);return n||(n=new Qr(t,{verifyEvent:this.trustedRelayURLs.has(t)?rc:this.verifyEvent,websocketImplementation:this._WebSocket}),e!=null&&e.connectionTimeout&&(n.connectionTimeout=e.connectionTimeout),this.relays.set(t,n)),await n.connect(),n}close(t){t.map(it).forEach(e=>{var n;(n=this.relays.get(e))==null||n.close()})}subscribe(t,e,n){return this.subscribeMap(t.map(r=>({url:r,filter:e})),n)}subscribeMany(t,e,n){return this.subscribeMap(t.flatMap(r=>e.map(o=>({url:r,filter:o}))),n)}subscribeMap(t,e){this.trackRelays&&(e.receivedEvent=(f,u)=>{let h=this.seenOn.get(u);h||(h=new Set,this.seenOn.set(u,h)),h.add(f)});const n=new Set,r=[],o=[];let i=f=>{var u;o[f]||(o[f]=!0,o.filter(h=>h).length===t.length&&((u=e.oneose)==null||u.call(e),i=()=>{}))};const s=[];let c=(f,u)=>{var h;s[f]||(i(f),s[f]=u,s.filter(d=>d).length===t.length&&((h=e.onclose)==null||h.call(e,s),c=()=>{}))};const a=f=>{var h;if((h=e.alreadyHaveEvent)!=null&&h.call(e,f))return!0;const u=n.has(f);return n.add(f),u},l=Promise.all(t.map(async({url:f,filter:u},h)=>{f=it(f);let d;try{d=await this.ensureRelay(f,{connectionTimeout:e.maxWait?Math.max(e.maxWait*.8,e.maxWait-1e3):void 0})}catch(b){c(h,(b==null?void 0:b.message)||String(b));return}let w=d.subscribe([u],{...e,oneose:()=>i(h),onclose:b=>{b.startsWith("auth-required:")&&e.doauth?d.auth(e.doauth).then(()=>{d.subscribe([u],{...e,oneose:()=>i(h),onclose:g=>{c(h,g)},alreadyHaveEvent:a,eoseTimeout:e.maxWait})}).catch(g=>{c(h,`auth was required and attempted, but failed with: ${g}`)}):c(h,b)},alreadyHaveEvent:a,eoseTimeout:e.maxWait});r.push(w)}));return{async close(){await l,r.forEach(f=>{f.close()})}}}subscribeManyMap(t,e){this.trackRelays&&(e.receivedEvent=(u,h)=>{let d=this.seenOn.get(h);d||(d=new Set,this.seenOn.set(h,d)),d.add(u)});const n=new Set,r=[],o=Object.keys(t).length,i=[];let s=u=>{var h;i[u]||(i[u]=!0,i.filter(d=>d).length===o&&((h=e.oneose)==null||h.call(e),s=()=>{}))};const c=[];let a=(u,h)=>{var d;c[u]||(s(u),c[u]=h,c.filter(w=>w).length===o&&((d=e.onclose)==null||d.call(e,c),a=()=>{}))};const l=u=>{var d;if((d=e.alreadyHaveEvent)!=null&&d.call(e,u))return!0;const h=n.has(u);return n.add(u),h},f=Promise.all(Object.entries(t).map(async(u,h,d)=>{if(d.indexOf(u)!==h){a(h,"duplicate url");return}let[w,b]=u;w=it(w);let g;try{g=await this.ensureRelay(w,{connectionTimeout:e.maxWait?Math.max(e.maxWait*.8,e.maxWait-1e3):void 0})}catch(y){a(h,(y==null?void 0:y.message)||String(y));return}let p=g.subscribe(b,{...e,oneose:()=>s(h),onclose:y=>{y.startsWith("auth-required:")&&e.doauth?g.auth(e.doauth).then(()=>{g.subscribe(b,{...e,oneose:()=>s(h),onclose:k=>{a(h,k)},alreadyHaveEvent:l,eoseTimeout:e.maxWait})}).catch(k=>{a(h,`auth was required and attempted, but failed with: ${k}`)}):a(h,y)},alreadyHaveEvent:l,eoseTimeout:e.maxWait});r.push(p)}));return{async close(){await f,r.forEach(u=>{u.close()})}}}subscribeEose(t,e,n){const r=this.subscribe(t,e,{...n,oneose(){r.close()}});return r}subscribeManyEose(t,e,n){const r=this.subscribeMany(t,e,{...n,oneose(){r.close()}});return r}async querySync(t,e,n){return new Promise(async r=>{const o=[];this.subscribeEose(t,e,{...n,onevent(i){o.push(i)},onclose(i){r(o)}})})}async get(t,e,n){e.limit=1;const r=await this.querySync(t,e,n);return r.sort((o,i)=>i.created_at-o.created_at),r[0]||null}publish(t,e){return t.map(it).map(async(n,r,o)=>{if(o.indexOf(n)!==r)return Promise.reject("duplicate url");let i=await this.ensureRelay(n);return i.publish(e).then(s=>{if(this.trackRelays){let c=this.seenOn.get(e.id);c||(c=new Set,this.seenOn.set(e.id,c)),c.add(i)}return s})})}listConnectionStatus(){const t=new Map;return this.relays.forEach((e,n)=>t.set(n,e.connected)),t}destroy(){this.relays.forEach(t=>t.close()),this.relays=new Map}},Xr;try{Xr=WebSocket}catch{}var sc=class extends ic{constructor(){super({verifyEvent:Dr,websocketImplementation:Xr})}},eo;try{eo=fetch}catch{}var qt=/^bunker:\/\/([0-9a-f]{64})\??([?\/\w:.=&%-]*)$/;async function cc(t){let e=t.match(qt);if(e)try{const n=e[1],r=new URLSearchParams(e[2]);return{pubkey:n,relays:r.getAll("relay"),secret:r.get("secret")}}catch{}return ac(t)}async function ac(t){const e=t.match(Gs);if(!e)return null;const[n,r="_",o]=e;try{const i=`https://${o}/.well-known/nostr.json?name=${r}`,s=await(await eo(i,{redirect:"error"})).json();let c=s.names[r],a=s.nip46[c]||[];return{pubkey:c,relays:a,secret:null}}catch{return null}}var lc=class{constructor(t,e,n={}){v(this,"pool");v(this,"subCloser");v(this,"isOpen");v(this,"serial");v(this,"idPrefix");v(this,"listeners");v(this,"waitingForAuth");v(this,"secretKey");v(this,"conversationKey");v(this,"bp");v(this,"cachedPubKey");if(e.relays.length===0)throw new Error("no relays are specified for this bunker");this.pool=n.pool||new sc,this.secretKey=t,this.conversationKey=$s(t,e.pubkey),this.bp=e,this.isOpen=!1,this.idPrefix=Math.random().toString(36).substring(7),this.serial=0,this.listeners={},this.waitingForAuth={},this.setupSubscription(n)}setupSubscription(t){const e=this.listeners,n=this.waitingForAuth,r=this.conversationKey;this.subCloser=this.pool.subscribe(this.bp.relays,{kinds:[Jr],authors:[this.bp.pubkey],"#p":[qs(this.secretKey)]},{onevent:async o=>{const i=JSON.parse(Fs(o.content,r)),{id:s,result:c,error:a}=i;if(c==="auth_url"&&n[s]){delete n[s],t.onauth?t.onauth(a):console.warn(`nostr-tools/nip46: remote signer ${this.bp.pubkey} tried to send an "auth_url"='${a}' but there was no onauth() callback configured.`);return}let l=e[s];l&&(a?l.reject(a):c&&l.resolve(c),delete e[s])},onclose:()=>{this.isOpen&&(this.subCloser.close(),this.setupSubscription(t))}}),this.isOpen=!0}async close(){this.isOpen=!1,this.subCloser.close()}async sendRequest(t,e){return new Promise(async(n,r)=>{try{if(!this.isOpen)throw new Error("this signer is not open anymore, create a new one");this.serial++;const o=`${this.idPrefix}-${this.serial}`,i=Vs(JSON.stringify({id:o,method:t,params:e}),this.conversationKey),s=js({kind:Jr,tags:[["p",this.bp.pubkey]],content:i,created_at:Math.floor(Date.now()/1e3)},this.secretKey);this.listeners[o]={resolve:n,reject:r},this.waitingForAuth[o]=!0,await Promise.any(this.pool.publish(this.bp.relays,s))}catch(o){r(o)}})}async ping(){let t=await this.sendRequest("ping",[]);if(t!=="pong")throw new Error(`result is not pong: ${t}`)}async connect(){await this.sendRequest("connect",[this.bp.pubkey,this.bp.secret||""])}async getPublicKey(){return this.cachedPubKey||(this.cachedPubKey=await this.sendRequest("get_public_key",[])),this.cachedPubKey}async getRelays(){return JSON.parse(await this.sendRequest("get_relays",[]))}async signEvent(t){let e=await this.sendRequest("sign_event",[JSON.stringify(t)]),n=JSON.parse(e);if(Dr(n))return n;throw new Error(`event returned from bunker is improperly signed: ${JSON.stringify(n)}`)}async nip04Encrypt(t,e){return await this.sendRequest("nip04_encrypt",[t,e])}async nip04Decrypt(t,e){return await this.sendRequest("nip04_decrypt",[t,e])}async nip44Encrypt(t,e){return await this.sendRequest("nip44_encrypt",[t,e])}async nip44Decrypt(t,e){return await this.sendRequest("nip44_decrypt",[t,e])}},uc=/^(?:([\w.+-]+)@)?([\w_-]+(\.[\w_-]+)+)$/,fc;try{fc=fetch}catch{}new TextDecoder("utf-8"),new TextEncoder;var dc=5e3;function hc(t){return gc("npub",Fn(t))}function bc(t,e){let n=Kr.toWords(e);return Kr.encode(t,n,dc)}function gc(t,e){return bc(t,e)}const st=[];function pc(t,e=U){let n;const r=new Set;function o(c){if($t(t,c)&&(t=c,n)){const a=!st.length;for(const l of r)l[1](),st.push(l,t);if(a){for(let l=0;l<st.length;l+=2)st[l][0](st[l+1]);st.length=0}}}function i(c){o(c(t))}function s(c,a=U){const l=[c,a];return r.add(l),r.size===1&&(n=e(o,i)||U),c(t),()=>{r.delete(l),r.size===0&&n&&(n(),n=null)}}return{set:o,update:i,subscribe:s}}const wc=t=>{const{subscribe:e,set:n}=pc(void 0,()=>{const r=window.matchMedia(t);n(r.matches);const o=()=>n(r.matches);return r.addEventListener("change",o),()=>{r.removeEventListener("change",o)}});return{subscribe:e}};function yc(t){let e,n,r;return{c(){e=zt("svg"),n=zt("circle"),r=zt("path"),E(n,"class","opacity-25"),E(n,"cx","12"),E(n,"cy","12"),E(n,"r","10"),E(n,"stroke","currentColor"),E(n,"stroke-width","4"),E(r,"class","opacity-75"),E(r,"fill","currentColor"),E(r,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),E(e,"class","ml-2 h-5 w-5 animate-spin text-white"),E(e,"xmlns","http://www.w3.org/2000/svg"),E(e,"fill","none"),E(e,"viewBox","0 0 24 24")},m(o,i){H(o,e,i),I(e,n),I(e,r)},p:U,i:U,o:U,d(o){o&&R(e)}}}class to extends Dn{constructor(e){super(),Wn(this,e,null,yc,$t,{})}}const{window:Tn}=So;function mc(t){let e,n,r,o,i,s,c,a,l,f,u,h,d=!t[17]&&!t[10]&&!t[11]&&!t[12]&&no(t);const w=[Ic,Bc,Ac,Sc,kc,_c,Ec],b=[];function g(p,y){return p[10]?0:p[11]?1:p[12]?2:p[17]?3:p[15]?4:p[18]?6:5}return c=g(t),a=b[c]=w[c](t),{c(){e=O("div"),n=O("button"),r=V(""),i=Z(),d&&d.c(),s=Z(),a.c(),E(n,"class",o="absolute right-2 top-0 cursor-pointer bg-transparent text-3xl text-"+t[0]+"-600"),E(e,"class",l="animate-show rounded-md bg-gradient-to-b px-8 py-8 shadow-[0_0px_30px_0px_rgba(0,0,0,0.6)] transition-all sm:w-96 bg-"+t[0]+"-800 from-"+t[0]+"-900 to-"+t[0]+"-700 "+t[23])},m(p,y){H(p,e,y),I(e,n),I(n,r),I(e,i),d&&d.m(e,null),I(e,s),b[c].m(e,null),f=!0,u||(h=te(n,"click",function(){jt(t[17]?t[28]:t[26])&&(t[17]?t[28]:t[26]).apply(this,arguments)}),u=!0)},p(p,y){t=p,(!f||y[0]&1&&o!==(o="absolute right-2 top-0 cursor-pointer bg-transparent text-3xl text-"+t[0]+"-600"))&&E(n,"class",o),!t[17]&&!t[10]&&!t[11]&&!t[12]?d?d.p(t,y):(d=no(t),d.c(),d.m(e,s)):d&&(d.d(1),d=null);let k=c;c=g(t),c===k?b[c].p(t,y):(vt(),pe(b[k],1,1,()=>{b[k]=null}),xt(),a=b[c],a?a.p(t,y):(a=b[c]=w[c](t),a.c()),de(a,1),a.m(e,null)),(!f||y[0]&8388609&&l!==(l="animate-show rounded-md bg-gradient-to-b px-8 py-8 shadow-[0_0px_30px_0px_rgba(0,0,0,0.6)] transition-all sm:w-96 bg-"+t[0]+"-800 from-"+t[0]+"-900 to-"+t[0]+"-700 "+t[23]))&&E(e,"class",l)},i(p){f||(de(a),f=!0)},o(p){pe(a),f=!1},d(p){p&&R(e),d&&d.d(),b[c].d(),u=!1,h()}}}function vc(t){let e,n,r,o,i;const s=[Hc,Rc,Lc,Cc],c=[];function a(l,f){return l[9]?0:l[18]?l[2]?3:2:1}return n=a(t),r=c[n]=s[n](t),{c(){e=O("div"),r.c(),E(e,"class",o="rounded px-2 py-2 shadow-[0_0px_10px_0px_rgba(0,0,0,0.3)] transition-all duration-200 bg-"+t[0]+"-700 hover:bg-"+t[0]+"-800 "+t[23])},m(l,f){H(l,e,f),c[n].m(e,null),i=!0},p(l,f){let u=n;n=a(l),n===u?c[n].p(l,f):(vt(),pe(c[u],1,1,()=>{c[u]=null}),xt(),r=c[n],r?r.p(l,f):(r=c[n]=s[n](l),r.c()),de(r,1),r.m(e,null)),(!i||f[0]&8388609&&o!==(o="rounded px-2 py-2 shadow-[0_0px_10px_0px_rgba(0,0,0,0.3)] transition-all duration-200 bg-"+l[0]+"-700 hover:bg-"+l[0]+"-800 "+l[23]))&&E(e,"class",o)},i(l){i||(de(r),i=!0)},o(l){pe(r),i=!1},d(l){l&&R(e),c[n].d()}}}function xc(t){return{c:U,m:U,p:U,i:U,o:U,d:U}}function no(t){let e,n,r,o,i;return{c(){e=O("button"),n=V("?"),E(e,"class",r="absolute bottom-1 right-3 cursor-pointer bg-transparent text-xl text-"+t[0]+"-600")},m(s,c){H(s,e,c),I(e,n),o||(i=te(e,"click",t[27]),o=!0)},p(s,c){c[0]&1&&r!==(r="absolute bottom-1 right-3 cursor-pointer bg-transparent text-xl text-"+s[0]+"-600")&&E(e,"class",r)},d(s){s&&R(e),o=!1,i()}}}function Ec(t){let e,n,r,o,i,s,c=t[18].npub+"",a,l,f,u,h,d,w,b,g,p,y,k=kr(t[8])+"",C,T,S,_=(t[18].picture||t[18].name)&&ro(t);return{c(){e=O("div"),n=O("div"),n.textContent="You are connected to Nostr as",r=Z(),o=O("a"),_&&_.c(),i=Z(),s=O("div"),a=V(c),f=Z(),u=O("button"),h=V("Disconnect"),w=Z(),b=O("div"),g=V("This webpage is using the public key:"),p=O("br"),y=Z(),C=V(k),E(n,"class","mb-4 text-sm"),E(s,"class","block break-all"),E(o,"target","_blank"),E(o,"href",l="https://nosta.me/"+t[18].npub),E(o,"class","group text-white no-underline"),E(e,"class","text-center"),E(u,"class",d="my-2 mt-6 block w-full cursor-pointer rounded border-0 px-2 py-1 text-lg text-white bg-"+t[0]+"-900 hover:bg-"+t[0]+"-950"),E(b,"class","mt-6 block break-all text-center text-sm")},m(m,P){H(m,e,P),I(e,n),I(e,r),I(e,o),_&&_.m(o,null),I(o,i),I(o,s),I(s,a),H(m,f,P),H(m,u,P),I(u,h),H(m,w,P),H(m,b,P),I(b,g),I(b,p),I(b,y),I(b,C),T||(S=te(u,"click",t[30]),T=!0)},p(m,P){m[18].picture||m[18].name?_?_.p(m,P):(_=ro(m),_.c(),_.m(o,i)):_&&(_.d(1),_=null),P[0]&262144&&c!==(c=m[18].npub+"")&&Oe(a,c),P[0]&262144&&l!==(l="https://nosta.me/"+m[18].npub)&&E(o,"href",l),P[0]&1&&d!==(d="my-2 mt-6 block w-full cursor-pointer rounded border-0 px-2 py-1 text-lg text-white bg-"+m[0]+"-900 hover:bg-"+m[0]+"-950")&&E(u,"class",d),P[0]&256&&k!==(k=kr(m[8])+"")&&Oe(C,k)},i:U,o:U,d(m){m&&(R(e),R(f),R(u),R(w),R(b)),_&&_.d(),T=!1,S()}}}function _c(t){let e,n,r,o,i,s,c,a,l,f,u,h,d,w,b,g,p,y=t[16]&&so(t);const k=[Tc,Oc],C=[];function T(m,P){return m[9]?0:1}a=T(t),l=C[a]=k[a](t);let S=t[9]&&t[13]&&co(t),_=!t[9]&&ao(t);return{c(){e=O("div"),e.textContent="How do you want to connect to Nostr?",n=Z(),r=O("form"),o=O("input"),i=Z(),y&&y.c(),s=Z(),c=O("button"),l.c(),h=Z(),S&&S.c(),d=Z(),_&&_.c(),w=Mn(),E(e,"class","text-center text-lg"),E(o,"class","box-border w-full rounded px-2 py-1 text-lg text-neutral-800 outline-none"),E(o,"placeholder","user@provider or bunker://..."),o.autofocus=!0,o.disabled=t[9],E(o,"autocapitalize","none"),E(c,"class",f="mt-4 flex w-full cursor-pointer items-center justify-center rounded border-0 px-2 py-1 text-lg text-white disabled:cursor-default disabled:bg-neutral-400 disabled:text-neutral-200 bg-"+t[0]+"-900 hover:bg-"+t[0]+"-950"),c.disabled=u=!t[22]||t[9],E(r,"class","mb-1 mt-4 flex flex-col")},m(m,P){H(m,e,P),H(m,n,P),H(m,r,P),I(r,o),t[44](o),qn(o,t[4]),I(r,i),y&&y.m(r,null),I(r,s),I(r,c),C[a].m(c,null),I(r,h),S&&S.m(r,null),H(m,d,P),_&&_.m(m,P),H(m,w,P),b=!0,o.focus(),g||(p=[te(o,"input",t[45]),te(r,"submit",t[29])],g=!0)},p(m,P){(!b||P[0]&512)&&(o.disabled=m[9]),P[0]&16&&o.value!==m[4]&&qn(o,m[4]),m[16]?y?y.p(m,P):(y=so(m),y.c(),y.m(r,s)):y&&(y.d(1),y=null);let L=a;a=T(m),a!==L&&(vt(),pe(C[L],1,1,()=>{C[L]=null}),xt(),l=C[a],l||(l=C[a]=k[a](m),l.c()),de(l,1),l.m(c,null)),(!b||P[0]&1&&f!==(f="mt-4 flex w-full cursor-pointer items-center justify-center rounded border-0 px-2 py-1 text-lg text-white disabled:cursor-default disabled:bg-neutral-400 disabled:text-neutral-200 bg-"+m[0]+"-900 hover:bg-"+m[0]+"-950"))&&E(c,"class",f),(!b||P[0]&4194816&&u!==(u=!m[22]||m[9]))&&(c.disabled=u),m[9]&&m[13]?S?S.p(m,P):(S=co(m),S.c(),S.m(r,null)):S&&(S.d(1),S=null),m[9]?_&&(_.d(1),_=null):_?_.p(m,P):(_=ao(m),_.c(),_.m(w.parentNode,w))},i(m){b||(de(l),b=!0)},o(m){pe(l),b=!1},d(m){m&&(R(e),R(n),R(r),R(d),R(w)),t[44](null),y&&y.d(),C[a].d(),S&&S.d(),_&&_.d(m),g=!1,Ie(p)}}}function kc(t){let e,n,r,o,i,s,c,a,l,f,u,h,d,w,b;return{c(){e=O("div"),e.textContent="Create a Nostr account",n=Z(),r=O("div"),r.textContent=`To use this Nostr app you need a profile. The following button opens a
          wizard that help you to create your keypair and safely manage it in a
          few steps. Are you ready?`,o=Z(),i=O("button"),s=V("Create an account "),a=Z(),l=O("div"),f=V("Do you already have a Nostr address?"),u=O("br"),h=Z(),d=O("button"),d.textContent="Login now",E(e,"class","text-center text-lg"),E(r,"class","mt-4 text-base leading-5"),E(i,"class",c="mt-4 block w-full cursor-pointer rounded border-0 px-2 py-1 text-lg text-white disabled:cursor-default disabled:bg-neutral-400 disabled:text-neutral-200 bg-"+t[0]+"-900 hover:bg-"+t[0]+"-950"),i.disabled=zc,E(d,"class","cursor-pointer border-0 bg-transparent text-sm text-white underline"),E(l,"class","mt-6 text-center text-sm leading-3")},m(g,p){H(g,e,p),H(g,n,p),H(g,r,p),H(g,o,p),H(g,i,p),I(i,s),H(g,a,p),H(g,l,p),I(l,f),I(l,u),I(l,h),I(l,d),w||(b=[te(i,"click",t[37]),te(d,"click",t[32])],w=!0)},p(g,p){p[0]&1&&c!==(c="mt-4 block w-full cursor-pointer rounded border-0 px-2 py-1 text-lg text-white disabled:cursor-default disabled:bg-neutral-400 disabled:text-neutral-200 bg-"+g[0]+"-900 hover:bg-"+g[0]+"-950")&&E(i,"class",c)},i:U,o:U,d(g){g&&(R(e),R(n),R(r),R(o),R(i),R(a),R(l)),w=!1,Ie(b)}}}function Sc(t){let e,n,r;return{c(){e=O("div"),e.textContent="What is that?",n=Z(),r=O("div"),r.innerHTML=`<p class="mb mt-4">This widget is created with <i>window.nostr.js</i>, a small script
            you can drop in any page that already uses NIP-07 and make it also
            work with NIP-46 automatically when the user doesn&#39;t have an
            extension installed.
            <br/>
            It adds a small floating button on the side of the window that users
            can use to create Nostr accuonts or connect to their NIP-46 bunkers.</p> <p class="mt-4">This tool is opensource, get the code from the <a target="_blank" class="underline" href="https://github.com/fiatjaf/window.nostr.js">project&#39;s page</a>.</p> <p class="mt-4">You don&#39;t know what Nostr is?
            <a target="_blank" class="underline" href="https://www.nostr.com">Learn more</a>.</p>`,E(e,"class","text-center text-lg"),E(r,"class","text-base leading-5")},m(o,i){H(o,e,i),H(o,n,i),H(o,r,i)},p:U,i:U,o:U,d(o){o&&(R(e),R(n),R(r))}}}function Ac(t){let e,n,r,o,i,s,c=new URL(t[12]).host+"",a,l,f,u,h,d,w,b,g,p;return{c(){e=O("div"),n=O("div"),n.textContent="An action requires your confirmation",r=Z(),o=O("div"),i=V("A new window will now open, taking you to "),s=O("strong"),a=V(c),l=V(`
            where you can approve the current action. If nothing happens, ensure
            your browser is not blocking popups.`),f=O("br"),u=V(`
            Afterward, you'll be redirected back to this page.`),h=Z(),d=O("button"),w=V("Confirm action "),E(n,"class","text-center text-lg"),E(o,"class","mt-4 text-center text-sm leading-4"),E(d,"class",b="mt-4 block w-full cursor-pointer rounded border-0 px-2 py-1 text-lg text-white disabled:cursor-default disabled:bg-neutral-400 disabled:text-neutral-200 bg-"+t[0]+"-900 hover:bg-"+t[0]+"-950"),E(e,"class","m-auto w-full")},m(y,k){H(y,e,k),I(e,n),I(e,r),I(e,o),I(o,i),I(o,s),I(s,a),I(o,l),I(o,f),I(o,u),I(e,h),I(e,d),I(d,w),g||(p=te(d,"click",t[43]),g=!0)},p(y,k){k[0]&4096&&c!==(c=new URL(y[12]).host+"")&&Oe(a,c),k[0]&1&&b!==(b="mt-4 block w-full cursor-pointer rounded border-0 px-2 py-1 text-lg text-white disabled:cursor-default disabled:bg-neutral-400 disabled:text-neutral-200 bg-"+y[0]+"-900 hover:bg-"+y[0]+"-950")&&E(d,"class",b)},i:U,o:U,d(y){y&&R(e),g=!1,p()}}}function Bc(t){let e,n,r,o,i,s,c=new URL(t[11]).host+"",a,l,f,u,h,d,w,b,g,p;return{c(){e=O("div"),n=O("div"),n.textContent="Login into a Nostr account",r=Z(),o=O("div"),i=V("A new window will now open, taking you to "),s=O("strong"),a=V(c),l=V(`
            where you can login and approve the permissions. If nothing happens,
            ensure your browser is not blocking popups. `),f=O("br"),u=V(`
            Afterward, you'll be redirected back to this page.`),h=Z(),d=O("button"),w=V("Login now "),E(n,"class","text-center text-lg"),E(o,"class","mt-4 text-center text-sm leading-4"),E(d,"class",b="mt-4 block w-full cursor-pointer rounded border-0 px-2 py-1 text-lg text-white disabled:cursor-default disabled:bg-neutral-400 disabled:text-neutral-200 bg-"+t[0]+"-900 hover:bg-"+t[0]+"-950"),E(e,"class","m-auto w-full")},m(y,k){H(y,e,k),I(e,n),I(e,r),I(e,o),I(o,i),I(o,s),I(s,a),I(o,l),I(o,f),I(o,u),I(e,h),I(e,d),I(d,w),g||(p=te(d,"click",t[42]),g=!0)},p(y,k){k[0]&2048&&c!==(c=new URL(y[11]).host+"")&&Oe(a,c),k[0]&1&&b!==(b="mt-4 block w-full cursor-pointer rounded border-0 px-2 py-1 text-lg text-white disabled:cursor-default disabled:bg-neutral-400 disabled:text-neutral-200 bg-"+y[0]+"-900 hover:bg-"+y[0]+"-950")&&E(d,"class",b)},i:U,o:U,d(y){y&&R(e),g=!1,p()}}}function Ic(t){let e,n,r,o,i,s,c=new URL(t[10]).host+"",a,l,f,u,h,d,w,b,g,p;return{c(){e=O("div"),n=O("div"),n.textContent="Create a Nostr account",r=Z(),o=O("div"),i=V(`A new window will now open, taking you to
            `),s=O("strong"),a=V(c),l=V(`
            where the account creation will occur. If nothing happens, ensure your
            browser is not blocking popups.
            `),f=O("br"),u=V(" Afterward, you'll be redirected back to this page."),h=Z(),d=O("button"),w=V("Start account creation "),E(n,"class","text-center text-lg"),E(o,"class","mt-4 text-center text-sm leading-4"),E(d,"class",b="mt-4 block w-full cursor-pointer rounded border-0 px-2 py-1 text-lg text-white disabled:cursor-default disabled:bg-neutral-400 disabled:text-neutral-200 bg-"+t[0]+"-900 hover:bg-"+t[0]+"-950"),E(e,"class","m-auto w-full")},m(y,k){H(y,e,k),I(e,n),I(e,r),I(e,o),I(o,i),I(o,s),I(s,a),I(o,l),I(o,f),I(o,u),I(e,h),I(e,d),I(d,w),g||(p=te(d,"click",t[41]),g=!0)},p(y,k){k[0]&1024&&c!==(c=new URL(y[10]).host+"")&&Oe(a,c),k[0]&1&&b!==(b="mt-4 block w-full cursor-pointer rounded border-0 px-2 py-1 text-lg text-white disabled:cursor-default disabled:bg-neutral-400 disabled:text-neutral-200 bg-"+y[0]+"-900 hover:bg-"+y[0]+"-950")&&E(d,"class",b)},i:U,o:U,d(y){y&&R(e),g=!1,p()}}}function ro(t){let e,n,r=t[18].picture&&oo(t),o=t[18].name&&io(t);return{c(){e=O("div"),r&&r.c(),n=Z(),o&&o.c(),E(e,"class","mb-2 flex items-center justify-center gap-2")},m(i,s){H(i,e,s),r&&r.m(e,null),I(e,n),o&&o.m(e,null)},p(i,s){i[18].picture?r?r.p(i,s):(r=oo(i),r.c(),r.m(e,n)):r&&(r.d(1),r=null),i[18].name?o?o.p(i,s):(o=io(i),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(i){i&&R(e),r&&r.d(),o&&o.d()}}}function oo(t){let e,n,r;return{c(){e=O("img"),Ye(e.src,n=t[18].picture)||E(e,"src",n),E(e,"alt",""),E(e,"class",r="h-10 w-10 rounded-full border-2 border-solid border-transparent group-hover:border-"+t[0]+"-100")},m(o,i){H(o,e,i)},p(o,i){i[0]&262144&&!Ye(e.src,n=o[18].picture)&&E(e,"src",n),i[0]&1&&r!==(r="h-10 w-10 rounded-full border-2 border-solid border-transparent group-hover:border-"+o[0]+"-100")&&E(e,"class",r)},d(o){o&&R(e)}}}function io(t){let e,n=t[18].name+"",r;return{c(){e=O("div"),r=V(n),E(e,"class","text-3xl decoration-2 underline-offset-4 group-hover:underline")},m(o,i){H(o,e,i),I(e,r)},p(o,i){i[0]&262144&&n!==(n=o[18].name+"")&&Oe(r,n)},d(o){o&&R(e)}}}function so(t){let e,n;return{c(){e=O("div"),n=V(t[16]),E(e,"class","my-2 rounded bg-yellow-100 p-2 text-center text-sm leading-4 text-red-400")},m(r,o){H(r,e,o),I(e,n)},p(r,o){o[0]&65536&&Oe(n,r[16])},d(r){r&&R(e)}}}function Oc(t){let e;return{c(){e=V("Connect ")},m(n,r){H(n,e,r)},i:U,o:U,d(n){n&&R(e)}}}function Tc(t){let e,n,r;return n=new to({}),{c(){e=V(`Connecting to bunker
              `),Kn(n.$$.fragment)},m(o,i){H(o,e,i),Vt(n,o,i),r=!0},i(o){r||(de(n.$$.fragment,o),r=!0)},o(o){pe(n.$$.fragment,o),r=!1},d(o){o&&R(e),Ft(n,o)}}}function co(t){let e,n,r,o,i;return{c(){e=O("div"),n=V(`Waiting too much?
              `),r=O("button"),r.textContent="Cancel the connection",E(r,"class","cursor-pointer border-0 bg-transparent text-sm text-white underline"),E(e,"class","mt-6 text-center text-sm leading-3")},m(s,c){H(s,e,c),I(e,n),I(e,r),o||(i=te(r,"click",t[33]),o=!0)},p:U,d(s){s&&R(e),o=!1,i()}}}function ao(t){let e;function n(i,s){return i[14]?Nc:Pc}let r=n(t),o=r(t);return{c(){e=O("div"),o.c(),E(e,"class","mt-6 text-center text-sm leading-3")},m(i,s){H(i,e,s),o.m(e,null)},p(i,s){r===(r=n(i))&&o?o.p(i,s):(o.d(1),o=r(i),o&&(o.c(),o.m(e,null)))},d(i){i&&R(e),o.d()}}}function Pc(t){let e,n,r,o,i,s;return{c(){e=V("Do you need a Nostr account?"),n=O("br"),r=Z(),o=O("button"),o.textContent="Sign up now",E(o,"class","cursor-pointer border-0 bg-transparent text-sm text-white underline")},m(c,a){H(c,e,a),H(c,n,a),H(c,r,a),H(c,o,a),i||(s=te(o,"click",t[37]),i=!0)},p:U,d(c){c&&(R(e),R(n),R(r),R(o)),i=!1,s()}}}function Nc(t){let e,n,r,o,i,s;return{c(){e=V("Is this bunker provider broken?"),n=O("br"),r=Z(),o=O("button"),o.textContent="Clear it",E(o,"class","cursor-pointer border-0 bg-transparent text-sm text-white underline")},m(c,a){H(c,e,a),H(c,n,a),H(c,r,a),H(c,o,a),i||(s=te(o,"click",t[31]),i=!0)},p:U,d(c){c&&(R(e),R(n),R(r),R(o)),i=!1,s()}}}function Cc(t){let e,n;return{c(){e=O("img"),Ye(e.src,n=t[18].picture)||E(e,"src",n),E(e,"alt",""),E(e,"class","h-6 w-6 rounded-full")},m(r,o){H(r,e,o)},p(r,o){o[0]&262144&&!Ye(e.src,n=r[18].picture)&&E(e,"src",n)},i:U,o:U,d(r){r&&R(e)}}}function Lc(t){let e,n,r,o=(t[18].name||t[18].npub.slice(0,7)+""+t[18].npub.slice(-4))+"",i;function s(l,f){return l[18].picture?Mc:Uc}let c=s(t),a=c(t);return{c(){e=O("div"),a.c(),n=Z(),r=O("div"),i=V(o),E(r,"class","inline-block max-w-56 overflow-hidden overflow-ellipsis whitespace-nowrap"),E(e,"class","flex items-center px-2")},m(l,f){H(l,e,f),a.m(e,null),I(e,n),I(e,r),I(r,i)},p(l,f){c===(c=s(l))&&a?a.p(l,f):(a.d(1),a=c(l),a&&(a.c(),a.m(e,n))),f[0]&262144&&o!==(o=(l[18].name||l[18].npub.slice(0,7)+""+l[18].npub.slice(-4))+"")&&Oe(i,o)},i:U,o:U,d(l){l&&R(e),a.d()}}}function Rc(t){let e;function n(i,s){return i[2]?jc:qc}let r=n(t),o=r(t);return{c(){o.c(),e=Mn()},m(i,s){o.m(i,s),H(i,e,s)},p(i,s){r!==(r=n(i))&&(o.d(1),o=r(i),o&&(o.c(),o.m(e.parentNode,e)))},i:U,o:U,d(i){i&&R(e),o.d(i)}}}function Hc(t){let e,n,r,o;return r=new to({}),{c(){e=O("div"),n=V(`Connecting to bunker
          `),Kn(r.$$.fragment),E(e,"class","flex items-center px-2")},m(i,s){H(i,e,s),I(e,n),Vt(r,e,null),o=!0},p:U,i(i){o||(de(r.$$.fragment,i),o=!0)},o(i){pe(r.$$.fragment,i),o=!1},d(i){i&&R(e),Ft(r)}}}function Uc(t){let e;return{c(){e=O("span"),e.textContent="",E(e,"class","mr-2")},m(n,r){H(n,e,r)},p:U,d(n){n&&R(e)}}}function Mc(t){let e,n;return{c(){e=O("img"),Ye(e.src,n=t[18].picture)||E(e,"src",n),E(e,"alt",""),E(e,"class","mr-2 h-5 w-5 rounded-full")},m(r,o){H(r,e,o)},p(r,o){o[0]&262144&&!Ye(e.src,n=r[18].picture)&&E(e,"src",n)},d(r){r&&R(e)}}}function qc(t){let e;return{c(){e=O("div"),e.textContent="Connect with Nostr",E(e,"class","flex items-center px-2")},m(n,r){H(n,e,r)},d(n){n&&R(e)}}}function jc(t){let e;return{c(){e=O("div"),e.textContent="N",E(e,"class","w-6 text-center")},m(n,r){H(n,e,r)},d(n){n&&R(e)}}}function $c(t){let e,n,r,o,i,s,c;const a=[xc,vc,mc],l=[];function f(u,h){return!u[21]&&!u[18]&&u[1]?0:u[21]?2:1}return n=f(t),r=l[n]=a[n](t),{c(){e=O("div"),r.c(),E(e,"class","draggable z-[9000] animate-fadein font-sans text-white"),E(e,"style",o="position: fixed; "+(t[21]&&t[5]?"width: 100vw;":"")+"; right: "+(t[21]&&t[5]?"0":t[3])+"px; user-select: none; "+(t[21]&&t[5]?"bottom: 0px":t[20]+":"+t[19]+"px")),jn(e,"cursor-pointer",!t[18]&&!t[21])},m(u,h){H(u,e,h),l[n].m(e,null),t[46](e),i=!0,s||(c=[te(Tn,"click",t[25]),te(Tn,"mouseup",t[36]),te(Tn,"mousemove",t[35]),te(e,"mousedown",t[34])],s=!0)},p(u,h){let d=n;n=f(u),n===d?l[n].p(u,h):(vt(),pe(l[d],1,1,()=>{l[d]=null}),xt(),r=l[n],r?r.p(u,h):(r=l[n]=a[n](u),r.c()),de(r,1),r.m(e,null)),(!i||h[0]&3670056&&o!==(o="position: fixed; "+(u[21]&&u[5]?"width: 100vw;":"")+"; right: "+(u[21]&&u[5]?"0":u[3])+"px; user-select: none; "+(u[21]&&u[5]?"bottom: 0px":u[20]+":"+u[19]+"px")))&&E(e,"style",o),(!i||h[0]&2359296)&&jn(e,"cursor-pointer",!u[18]&&!u[21])},i(u){i||(de(r),i=!0)},o(u){pe(r),i=!1},d(u){u&&R(e),l[n].d(),t[46](null),s=!1,Ie(c)}}}let zc=!1;const lo="We could not connect to a NIP-46 bunker with that url, are you sure it is set up correctly?",uo="We were not able to connect using this address. For it to work it has to come from a NIP-46 provider.",Ue=20;function Pn(t){return window.open(t,"window.nostr","width=600,height=800,popup=yes")}function Kc(t,e,n){let r,o,i,s,c,a;const l=window.location.hostname,f=window.location.protocol,u=wc("only screen and (max-width: 640px)");ko(t,u,B=>n(5,a=B));const h={ORIGIN:"wnj:origin",CLIENT_SECRET:"wnj:clientSecret",Y_POS:"wnj:ypos",CALLBACK_TOKEN:"wnj:callbackToken",BUNKER_POINTER:"wnj:bunkerPointer"};let d,{accent:w}=e,{position:b="top"}=e,{startHidden:g}=e,{compactMode:p}=e;const y=window,k=new ds;let C,T,S;const _=localStorage.getItem(h.CLIENT_SECRET);_?S=Fn(_):(S=Fi(),localStorage.setItem(h.CLIENT_SECRET,ce(S)));let m="closed",P=!1,L,q,Y,K,D,x,A=null,N=null,j=null,M=!1,W=!1,F,$,ie=!1,Q,he,ke=[],{right:be=20}=e,Ge=!1,ae=!1,Se,gt,Ae;const le={pool:k,onauth(B){F?n(10,A=B):Q?(n(12,j=B),n(39,m="opened")):n(11,N=B)}},Be=Uo(()=>{switch(m){case"justopened":n(39,m="opened");break;case"justclosed":n(39,m="closed");break}},500);function Me(){n(39,m="justopened"),Be()}function qe(){n(39,m="justclosed"),Be()}function at(){if(L&&!x){Rn();return}Me()}Ln();let mo={isWnj:!0,async getPublicKey(){let B,z;const X=new Promise((ge,pt)=>{B=pt,(async()=>{try{!D&&!x&&at();const Hn=await(await K).getPublicKey();z.settled=!0,ge(Hn)}catch(Hn){z.settled=!0,pt(Hn)}})()});return z={promise:X,reject:B,settled:!1},ke.push(z),X},async signEvent(B){try{return!D&&!x&&at(),await(await K).signEvent(B)}finally{n(12,j=null),qe()}},async getRelays(){return{}},nip04:{async encrypt(B,z){return!D&&!x&&at(),(await K).nip04Encrypt(B,z)},async decrypt(B,z){return!D&&!x&&at(),(await K).nip04Decrypt(B,z)}},nip44:{async encrypt(B,z){return!D&&!x&&at(),(await K).nip44Encrypt(B,z)},async decrypt(B,z){return!D&&!x&&at(),(await K).nip44Decrypt(B,z)}}};function Ln(){qe(),L=null,K=new Promise((B,z)=>{q=B,Y=z}),n(18,Q=null),n(9,D=!1),n(13,M=!1),n(15,F=!1),x=!1,he=null,n(16,$="")}Io(()=>{const B=window.location.hash;if(B.startsWith("#nostr-login=")){const z=B.substring(B.indexOf("=")+1),X=window.location.href.split("#")[0];if(history.replaceState(null,"",X),z.startsWith("bunker://")){n(4,T=z);const ge=new SubmitEvent("submit",{bubbles:!0,cancelable:!0});P=!0,Me(),vo(ge)}}if(!L){let z=localStorage.getItem(h.BUNKER_POINTER);if(z){L=JSON.parse(z);let X=new URL(`bunker://${L.pubkey}`);L.relays.forEach(ge=>{X.searchParams.append("relay",ge)}),L.secret&&X.searchParams.set("secret",L.secret),n(4,T=X.toString()),xo(),Rn()}}if(y.nostr&&!y.nostr.isWnj){y.destroyWnj();return}else Object.defineProperty(window,"nostr",{get(){return mo},set(z){const X=new Error("Nostr extension took over, please retry the operation");ke.forEach(ge=>{if(!ge.settled)try{ge.reject(X)}catch{}}),ke=[],mo=z,z.isWnj||y.destroyWnj()},configurable:!0});return()=>{he&&he.close()}});function Vc(B){Math.abs(o-gt)>6||Date.now()-Ae>600||m==="justopened"||m==="justclosed"||(B.composedPath().find(z=>z.id==="wnj")?Me():qe())}function Fc(B){qe(),n(15,F=!1),n(10,A=null),n(11,N=null),n(12,j=null),B.stopPropagation()}function Gc(B){n(17,ie=!0),B.stopPropagation()}function Yc(B){n(17,ie=!1),B.stopPropagation()}async function vo(B){B.preventDefault();try{if(L=await cc(T),!L){T.match(qt)?n(16,$=lo):n(16,$=uo);return}C.setCustomValidity(""),n(16,$=""),await Rn(),xo()}catch{T.match(qt)?n(16,$=lo):n(16,$=uo),n(9,D=!1)}}async function Zc(B){B.preventDefault(),localStorage.removeItem(h.BUNKER_POINTER),Ln()}async function Jc(B){B.preventDefault(),n(4,T=""),localStorage.removeItem(h.BUNKER_POINTER),n(14,W=!1)}function Qc(B){n(15,F=!1)}function Xc(){n(13,M=!1),n(9,D=!1),Y("connection aborted"),Ln(),Me()}async function Rn(B=void 0){B=B||new lc(S,L,le),n(9,D=!0);let z=setTimeout(()=>{n(13,M=!0),n(39,m="opened")},5e3);try{await B.connect(),x=!0,localStorage.setItem(h.BUNKER_POINTER,JSON.stringify(L)),qe(),q(B)}catch(X){Y((X==null?void 0:X.message)||String(X))}finally{clearTimeout(z),n(9,D=!1),n(13,M=!1),n(10,A=null),n(11,N=null),n(12,j=null),P&&Me()}}async function xo(){let B;try{B=await(await K).getPublicKey()}catch{n(14,W=!0);return}n(18,Q={pubkey:B,npub:hc(B),event:null}),he=k.subscribeMany(["wss://purplepag.es","wss://relay.snort.social","wss://relay.nos.social"],[{kinds:[0],authors:[B]}],{onevent(z){var X;if(!((((X=Q.event)==null?void 0:X.created_at)||0)>=z.created_at))try{let{name:ge,picture:pt}=JSON.parse(z.content);n(18,Q.event=z,Q),n(18,Q.name=ge,Q),n(18,Q.picture=pt,Q)}catch{}}})}function ea(B){if(i)return;Ge=!0;const z=d.getBoundingClientRect();Se=B.clientY-z.top,gt=o,Ae=Date.now()}function ta(B){Ge&&(r==="top"?n(19,o=B.clientY):n(19,o=window.innerHeight-B.clientY),n(19,o-=Se),n(40,ae=!0),o<Ue&&n(19,o=Ue),o>window.innerHeight-Ue&&n(19,o=window.innerHeight-Ue))}function na(){if(Ge=!1,setTimeout(()=>{n(40,ae=!1)},10),ae){const B=d.getBoundingClientRect(),z=window.innerHeight,X=z/2;B.top<X?(n(20,r="top"),n(19,o=B.top)):(n(20,r="bottom"),n(19,o=z-B.bottom)),o<Ue&&n(19,o=Ue),localStorage.setItem(h.ORIGIN,r),localStorage.setItem(h.Y_POS,o.toString())}}function ra(){window.location.href=`https://nstart.me?an=${l}&at=web&ac=${f}//${l}&sfb=yes`}const oa=()=>Pn(A),ia=()=>Pn(N),sa=()=>{Pn(j)};function ca(B){yt[B?"unshift":"push"](()=>{C=B,n(7,C)})}function aa(){T=this.value,n(4,T)}function la(B){yt[B?"unshift":"push"](()=>{d=B,n(6,d)})}return t.$$set=B=>{"accent"in B&&n(0,w=B.accent),"position"in B&&n(38,b=B.position),"startHidden"in B&&n(1,g=B.startHidden),"compactMode"in B&&n(2,p=B.compactMode),"right"in B&&n(3,be=B.right)},t.$$.update=()=>{t.$$.dirty[0]&32|t.$$.dirty[1]&128&&n(20,r=a?"bottom":localStorage.getItem(h.ORIGIN)||b),t.$$.dirty[0]&32&&n(19,o=a?Ue:parseInt(localStorage.getItem(h.Y_POS)||"0")||Ue),t.$$.dirty[1]&256&&n(21,i=m==="justopened"||m==="opened"),t.$$.dirty[0]&1|t.$$.dirty[1]&512&&n(23,s=ae?"cursor-grabbing outline-dashed outline-"+w+"-500 outline-1 outline-offset-4":"outline-none"),t.$$.dirty[0]&16&&n(22,c=T&&(T.match(qt)||T.match(uc)))},[w,g,p,be,T,a,d,C,S,D,A,N,j,M,W,F,$,ie,Q,o,r,i,c,s,u,Vc,Fc,Gc,Yc,vo,Zc,Jc,Qc,Xc,ea,ta,na,ra,b,m,ae,oa,ia,sa,ca,aa,la]}class Wc extends Dn{constructor(e){super(),Wn(this,e,Kc,$c,$t,{accent:0,position:38,startHidden:1,compactMode:2,right:3},null,[-1,-1,-1])}}const ct=window;ct.destroyWnj=()=>{setTimeout(()=>{Dc.$destroy()},1)};const Nn=document.createElement("div");Nn.style.zIndex="90000",document.body.appendChild(Nn);const Cn=document.createElement("div");Cn.id="wnj";const fo=document.createElement("style");fo.innerHTML=je;const ho=Nn.attachShadow({mode:"open"});ho.appendChild(Cn),ho.appendChild(fo);const Dc=new Wc({target:Cn,props:{accent:((bo=ct.wnjParams)==null?void 0:bo.accent)||"cyan",position:((go=ct.wnjParams)==null?void 0:go.position)==="bottom"?"bottom":"top",startHidden:(po=ct.wnjParams)==null?void 0:po.startHidden,compactMode:(wo=ct.wnjParams)==null?void 0:wo.compactMode}});if(!((yo=ct.wnjParams)!=null&&yo.disableOverflowFix)){const t=document.createElement("style"),e=`
    html, body {
      overflow: auto;
      height: 100%;
    }
  `;t.innerHTML=e,document.head.appendChild(t)}})();
